a:4:{s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"feed";a:1:{i:0;a:6:{s:4:"data";s:0:"";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:7:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:47:"
    <div lang="en" dir="ltr">miscoded</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:8:"subtitle";a:1:{i:0;a:5:{s:4:"data";s:56:"
    <div lang="en" dir="ltr">the web is a hack</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:4:"link";a:2:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:29:"http://my.opera.com/hallvors/";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:1;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:2:{s:3:"rel";s:4:"self";s:4:"href";s:42:"http://my.opera.com/hallvors/xml/atom/blog";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:25:" Hallvord R. M. Steen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:34:"http://my.opera.com/hallvors/blog/";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2010-02-16T21:36:31Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:5:"entry";a:20:{i:0;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:99:"
    <div lang="en" dir="ltr">SVG adds style.filter - now, where have we seen that before?</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:25:" Hallvord R. M. Steen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:50:"http://my.opera.com/hallvors/blog/show.dml/7869171";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:41:"http://my.opera.com/hallvors/blog/7869171";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2010-02-16T21:36:31Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:3516:"<div lang="en" dir="ltr">We&#039;ve been working away on Opera&#039;s <a href="http://www.w3.org/Graphics/SVG/" target="_blank">SVG</a> support for a while. 
<br>Recently, integrating SVG-specific CSS properties into the DOM implementation caused an unexpected problem: the &quot;filter&quot; concept in SVG styling and IE&#039;s proprietary &quot;filter&quot; suddenly exist in the same namespace - the CSSStyleDeclaration interface.
<br>
<br>If that was greek to you, here&#039;s a translation: in SVG, you can do something like 
<br><pre>&lt;circle style=&quot;filter: url(#someCoolEffectDefinedOverThere)&quot;&gt;</pre> and IE allows you to do something like 
<br><pre>&lt;div style=&quot;filter: alpha(opacity=50)&quot;&gt;</pre>
<br>This means that a browser supporting SVG will define element.style.filter - and all versions of IE you want to care about <strong>also</strong> define element.style.filter. So if you&#039;re writing a generic script and see a random element with a style.filter property - how do you know what filter syntax is supported?
<br>
<br>We discovered this problem due to failing opacity effects - scripts doing <pre>if(typeof element.style.filter != &#039;undefined&#039;){
 // IE syntax
}else{
 // standards-compliant syntax
}</pre>
<br>suddenly saw style.filter defined and started giving us IE-code. Seems Firefox <a href="http://longsonr.wordpress.com/2010/02/14/svg-tooltips-and-style-setting/" target="_blank">is about to</a> come across those compatibility problems too..
<br>
<br>Of course it raises a red flag when we add something that causes new compatibility issues. It has been raised <a href="http://www.w3.org/Graphics/SVG/WG/track/issues/2181" target="_blank">as an issue</a> with the SVG working group, who <a href="http://www.w3.org/2009/02/18-svg-minutes.html#item07" target="_blank">discussed it</a> and decided to sweep the issue under the carpet with an informative warning in the spec.
<br>
<br>For compatibility, we&#039;re considering hiding style.filter like we hide document.all. That is not a good solution, however. <strong>We want scripts to be able to detect that SVG filters can be manipulated from JavaScript, and we want them to do so through good, old, best-practice object detection.</strong>
<br>
<br>Microsoft will actually <a href="http://blogs.msdn.com/ie/archive/2008/09/08/microsoft-css-vendor-extensions.aspx" target="_blank">save us</a> by re-naming filter to ms-filter. That&#039;s excellent, if late, and they still have the problem that millions of existing sites use IE-style CSS filters. It would have been the perfect solution had they done it back when their CSS filters were invented.. I still welcome their initiative, but at this point it probably won&#039;t make any difference for many years ahead. Right now, we&#039;re stuck with confusion. I&#039;m worried that we&#039;re breaking established best-practice  (object detection) and forcing people down the dirty road of browser sniffing. I think it will be confusing that HTML elements get a &quot;filter&quot; property that will presumably only work when set on SVG elements.
<br>
<br>Now.. changing SVG&#039;s footprint in the CSS DOM wouldn&#039;t suffer from legacy content problems. <strong>My preferred solution would be to make sure &quot;filter&quot; only appears on the .style object of real SVG elements, and that it&#039;s named svgFilter in the DOM rather than just &quot;filter&quot;</strong>, to make it easier to detect. 
<br>
<br>What do you all think?</div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}i:1;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:64:"
    <div lang="en" dir="ltr">Dragonfly now open source</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:25:" Hallvord R. M. Steen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:50:"http://my.opera.com/hallvors/blog/show.dml/7765611";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:41:"http://my.opera.com/hallvors/blog/7765611";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2010-02-13T22:50:29Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:779:"<div lang="en" dir="ltr"><a href="http://my.opera.com/dragonfly/blog/opera-dragonfly-open-for-business" target="_blank">Get the news</a> if you haven&#039;t seen it already (with apologies to those of you who already read it - I know I&#039;m three busy days behind in re-posting this news item :) ).
<br>
<br>I&#039;ve been waiting for this and I hope open-sourcing Dragonfly will teach us some things about working in the open and maintaining developer communities - even more than we do already. (You may now start griping about the closed bug tracker but I&#039;m afraid you&#039;ll be ignored, because if I was making such decisions it would already be open..). 
<br>
<br>Who knows, interesting contributions for Dragonfly might inspire more open sourcing at Opera? :)</div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}i:2;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:60:"
    <div lang="en" dir="ltr">5-part JS quiz (link)</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:25:" Hallvord R. M. Steen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:50:"http://my.opera.com/hallvors/blog/show.dml/6641441";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:41:"http://my.opera.com/hallvors/blog/6641441";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2010-01-18T18:44:38Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:615:"<div lang="en" dir="ltr">Came across the blog post <a href="http://dmitry.baranovskiy.com/post/91403200" target="_blank">so, you think you know JavaScript?</a> by Dmitry Baranovskiy. It&#039;s a pretty nice little 5-part quiz on JavaScript quirks. I admit I did have one wrong answer (the fourth one), what&#039;s your score?
<br>
<br>Rather than just linking to it I&#039;ll explain all the examples and why exactly you get the result you do ... but not just yet :) I&#039;ll first let my dear readers dive in and take the quiz. Explanations will follow in comments (unless you all beat me to it, of course).</div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}i:3;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:60:"
    <div lang="en" dir="ltr">New sitepatching blog</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:25:" Hallvord R. M. Steen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:50:"http://my.opera.com/hallvors/blog/show.dml/6411981";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:41:"http://my.opera.com/hallvors/blog/6411981";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2010-01-12T13:20:10Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:178:"<div lang="en" dir="ltr"><span style="font-size: medium"><a href="http://my.opera.com/sitepatching/blog/" target="_blank">Follow browser.js updates and news here</a></span></div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}i:4;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:81:"
    <div lang="en" dir="ltr">Tracking down finnair.com&#039;s missing i</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:25:" Hallvord R. M. Steen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:50:"http://my.opera.com/hallvors/blog/show.dml/5461221";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:41:"http://my.opera.com/hallvors/blog/5461221";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2009-12-14T13:40:16Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:3933:"<div lang="en" dir="ltr">I guess <a href="http://www.finnair.com" target="_blank">Finnair</a> is the household&#039;s favourite airline. I don&#039;t think I&#039;ve used any other carrier during the last three years or so - we don&#039;t travel that much, so we&#039;re not talking many flights overall. However, it was rather annoying to find its website broken last time I wanted to look up some prices:
<br>
<br><span class="imgcenter"><img alt="" src="http://files.myopera.com/hallvors/blog/finnair1.png"></span>Finnair site auto-complete menu broken, error in console
<br>
<br>After selecting a local site, the auto-complete menu to choose departure and destination cities from never populates. What&#039;s worse: the site doesn&#039;t accept anything you type in by hand! If you haven&#039;t made a menu selection, <strong>you get an error message</strong>! I&#039;m sure that does wonders for their overall accessibility and section 508 compliance..
<br>
<br>The error message complains that they refer to a variable &quot;i&quot; that doesn&#039;t exist. Somewhat wrapped, the code looks like this:
<br>
<br><pre>a.Autocompleter.Cache=function(c){
	var f={};
	var d=0;
	function h(k,j){
		if(!c.matchCase){
			k=k.toLowerCase();
		}
		if(!k.startsWith(j)&amp;&amp;k.indexOf(&quot; &quot;+j)===-1&amp;&amp;k.indexOf(&quot;(&quot;+j)===-1){
			return false;
		}
		return i==0||c.matchContains;
	}</pre>
<br>The problem is the reference to i in the return statement. There is no variable &quot;i&quot; defined nearby, indeed not in the entire script file. That &quot;i==0&quot; looks like some dead code that isn&#039;t meant to be there anymore. But it works in other browsers, no?
<br>
<br>If I load the page in Firefox and type javascript:alert(window.i) into the address bar it says &quot;1&quot;, so in Firefox the site does somewhere create a global variable named i. The question is where?
<br>
<br>Firebug can&#039;t - as far as I know - break when a variable is initialized or changed. As always, <a href="http://www.fiddler2.com/fiddler2/" target="_blank">Fiddler</a> comes to the rescue - setting a &quot;HTTP breakpoint&quot; after response and re-loading the site in Firefox lets me add some simple debug code:
<br><span class="imgcenter"><img alt="" src="http://files.myopera.com/hallvors/blog/finnair2.png"></span>Fiddler screen in breakpoint mode, debug code highlighted
<br><pre>window.__defineSetter__ (&#039;i&#039;, function(){ try{ undefined() ; }catch(e){ console.log(e) ; } })</pre>
<br>When I click Fiddler&#039;s &quot;run to completion&quot; button, an error message appears in Firebug&#039;s console pointing to this function:
<br>
<br><pre>function isFirefoxWMPPluginInstalled(){
	var plugs=navigator.plugins;
	for(i=0;
	i&lt;plugs.length;
	i++){</pre>
<br>which given its name is naturally called after some browser sniffing, here:
<br><pre>type:$.browser.mozilla&amp;&amp;isFirefoxWMPPluginInstalled()?&quot;application/x-ms-wmp&quot;:&quot;application/x-mplayer2&quot;</pre>
<br>
<br>So this works in other browsers by pure luck - because JavaScript scoping rules are such that when you don&#039;t use &quot;var&quot; keyword to declare variables, they will be global, and Fnnar&#039;s code contains numerous loops that use &quot;i&quot; as a counter and don&#039;t use var. If such a loop happens to run before you try booking, the site will work for you. As if we needed any more evidence that JavaScript scoping rules suck..
<br>
<br>If we&#039;re going to site patch this error in <a href="http://www.opera.com/docs/browserjs/" target="_blank">browser.js</a>, the patch would be simply <strong>var i;</strong>. At 6 characters, I&#039;m fairly sure it would be the shortest site patch ever. Meanwhile, we&#039;ll contact them and hope Fnnar will get their &quot;i&quot;s back in order. 
<br>
<br>And I sure hope they deploy better software for their autopilot than their autocomplete...</div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}i:5;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:78:"
    <div lang="en" dir="ltr">New adventures in compatibility testing</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:25:" Hallvord R. M. Steen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:50:"http://my.opera.com/hallvors/blog/show.dml/5014291";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:41:"http://my.opera.com/hallvors/blog/5014291";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2009-12-02T13:12:03Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:6001:"<div lang="en" dir="ltr">I&#039;m having some fun trying to figure out how sites use document.getElementsByName(), and thought some of you might be interested in the testing approach.
<br>
<br>The bug I&#039;m investigating is a small and ugly one hiding in  the document.getElementsByName() implementation - <strong>getElementsByName(&#039;someID&#039;)</strong> will find an element with <strong>id=&quot;someID&quot;</strong>. 
<br>
<br>This is of course bad behaviour. That method has nothing to do with IDs and should find elements by name only.
<br>
<br>The good news is that it&#039;s trivial to fix. The bad news is that it&#039;s there for a reason, and the reason is called Internet Explorer. We&#039;ve been bug-compatible on purpose and while we&#039;d like to remove the bug we have no idea how many sites will break if we do!
<br>
<br>So, I&#039;d like an answer to questions like these:
<br><ul class="bullets"><li> How many sites use getElementsByName() to find elements with an ID?
<br>  </li><li> Do these sites break if we fix the bug?
<br>  </li><li> Do they have alternate code paths for browsers doing it right? If yes, how do they figure out what code to use?
<br></li></ul>
<br>Tools at our disposal: the <a href="http://dev.opera.com/articles/view/mama/" target="_blank">MAMA web code search engine</a> (an internal Opera project), User JavaScript, and two ad-hoc Opera Unite services. 
<br>
<br>MAMA tracks sites that might be using document.getElementsByName(). It knows about roughly 45 000 sites where it has seen the string &quot;getElementsByName&quot; in script source code, and it generously provides 5000 random ones in a text file on my request. Naturally, MAMA does only static analysis of the scripts, it can&#039;t tell whether the method is actually called or what it was used for.
<br>
<br>That information is a piece of cake to get with User JavaScript. A trivial custom script, <a href="http://files.myopera.com/hallvors/files/trackGEBNabuse.js" target="_blank">trackGEBNabuse.js</a>, overwrites the getElementsByName() method with one that will do a bit of debugging and logging on our behalf. And I&#039;m playing with Opera Unite for the first time, with one <a href="http://files.myopera.com/hallvors/files/unitelogger.ua" target="_blank">logging service</a> and one <a href="http://files.myopera.com/hallvors/files/urldriver.ua" target="_blank">URL player</a> that keeps track of which of the 5000 URLs were already visited and sends Opera to the next one.
<br>
<br>(Opera Unite actually rocks! It&#039;s fun to write backend-type logic in JavaScript rather than PHP, and it&#039;s less hassle while developing to keep all the information, URL lists, log files and scripts locally on the hard drive. I&#039;ve been undecided about Unite, not sure if it was more important than all the other things we should be spending time on - now I see it&#039;s maturing and making itself useful. Nice.)
<br>
<br>To walk you through the main logic of things - here&#039;s the user JS that overwrites the native method to do logging - commented:
<br>
<br><pre>
(function(gebn){/* &quot;gebn&quot; is a reference to the actual, native function */
	document.getElementsByName=function(name){ /* overwrite the real one */
		var elementList=gebn.apply(this, arguments); /* call the native function, record the list it returns */
		/* we want to know if anything in the elementList is there due to a matching id rather than a matching name */
		var abuse=[];
		for(var i=0,elm;elm=elementList[i];i++){ /* go through all returned elements */
			if( elm.getAttribute(&#039;name&#039;)!==name )abuse.push(elm.outerHTML); /* we found one that&#039;s probably in the list because of an ID attribute! */
		}
		if(abuse.length&gt;0){
			/* log errors to some server... */
			(new Image()).src=&#039;http://hr-opera.hallvors.operaunite.com/logger/logGEBN/?data=&#039;+encodeURIComponent(abuse.join(&#039;, &#039;))+&#039;&amp;href=&#039;+encodeURIComponent(location.href);
		}
		return elementList;/* don&#039;t forget to return the list of elements to the waiting script */
	}
})(document.getElementsByName); /* this is where we pass the real method as an argument to the function */
</pre>
<br>As you see, it uses the oldest trick in the book - <strong>new Image()</strong> - to ping the Unite service with some data. The data is then stored in the folder I told Opera Unite to use when installing the widget.
<br>
<br>The only other interesting part is the code that requests the next URL from the URL player - as trivial as doing this from a load event listener:
<br><pre>	if(location.hostname!=&#039;hr-opera.hallvors.operaunite.com&#039;)
		setTimeout( function(){ location.href=&#039;http://hr-opera.hallvors.operaunite.com/urldriver/nexturl?&#039;+Math.random(); }, 500 );</pre>
<br>The urldriver service also accepts the &quot;urllist=somefile.txt&quot; query string argument, so a different user scripts could play URLs from a different file (though not at the same time since the index of what URL one has reached is not stored per-file. That&#039;s obviously a bug in my Unite service - keep in mind that these are ad-hoc throwaway services done in 30 minutes of cutting, pasting and typing last night, so don&#039;t expect QA and polish :-p).
<br>
<br>And the results? Left an Opera 10.10 instance to surf on its own in 5 different tabs overnight, which generated <a href="http://files.myopera.com/hallvors/files/gEBN.log.txt" target="_blank">this log file</a> listing 6 unique sites and the HTML of the elements returned in response to a getElementsByName() call due to this bug. Analysing 6 out of 5000 URLs manually is certainly doable :). I&#039;m still worried about getElementsByName() usage that only happens during user interaction, but now at least we know that 0.12% of the sites out there might be at risk from any change and we have some real code to look at. And automated analysis of websites is a new and interesting use case for User JavaScript.</div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}i:6;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:91:"
    <div lang="en" dir="ltr">Onestat.com&#039;s browser sniffer older than my son</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:25:" Hallvord R. M. Steen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:50:"http://my.opera.com/hallvors/blog/show.dml/4327363";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:41:"http://my.opera.com/hallvors/blog/4327363";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2009-09-09T19:34:47Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:2272:"<div lang="en" dir="ltr">Seems the boss has been browsing web stats again - I came across a bug report from him saying a DHTML menu on <a href="http://onestat.com/" target="_blank">onestat.com</a> only works once. (Load page, click any &quot;demo&quot; link at the bottom and try the menu on the left.)
<br>
<br>I&#039;m not paying that much attention to stats myself, being too busy doing the work that will hopefully smoothen out compatibility problems and make it possible to grow our usage share. It&#039;s exactly the type of brokenness Jon found on onestat.com I fear the most - a bit hidden away, subtle, annoying when the user needs that page to work but perhaps not disastrous enough to notify us of. Too many of these issues, and we&#039;ve lost a user! (Unless, of course, the user happens to be our CEO :) - luckily he&#039;s an active surfer who comes across more compat problems than any average user and eagerly reports them ;)).
<br>
<br>Now, <a href="http://onestat.com/WebResource.axd?d=Z79k7fJCxnUKvZl84V7IvoGFWDYoJ4j6N9Gt3tXNsnPXmKUa5E3U0L6uF4hjAEakbnyEaQvzCaEy3hqKDph5bFcOmRSslu3q0YjVQbYzd-OQ2kgSvbqqNEcig6IAxOz40&amp;t=633296291205000000" target="_blank">deep inside the Onestat scripts</a> is some code to handle browser differences. The script assumes that a browser below a certain level of DOM support can&#039;t be expected to create menus after the document loaded. That&#039;s of course not a bad assumption to make - until you see the sniffing they use to determine whether you have sufficient DOM support. Here is the relevant part: 
<br><pre>
if(kh.indexOf(&quot;Opera/7&quot;)&gt;-1||kh.indexOf(&quot;Opera 7&quot;)&gt;-1)return &quot;Op7&quot;; 
. 
. 
else if(kh.indexOf(&quot;Opera&quot;)&gt;-1)return &quot;Default&quot;;</pre>
<br>
<br>Check the calendar, sir: we&#039;re in late 2009. Opera 7 - the only Opera version this script thinks is capable of opening the menu a second time - was released in January 2003. That&#039;s a 6 year old browser sniffer! <strong>I hope the script that generates their statistics is a bit more up to date</strong>!
<br>
<br>And it&#039;s more than a little ironic that a web statistics company contributes to Opera&#039;s low usage share by running such old and broken code on their website. :(</div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}i:7;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:87:"
    <div lang="en" dir="ltr">browser.js update: eBay, Sun webmail, Salesforce</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:25:" Hallvord R. M. Steen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:50:"http://my.opera.com/hallvors/blog/show.dml/4238091";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:41:"http://my.opera.com/hallvors/blog/4238091";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2009-08-12T22:36:44Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:5769:"<div lang="en" dir="ltr">A new <a href="http://www.opera.com/docs/browserjs/" target="_blank">browser.js</a> file is out, and like <a href="http://my.opera.com/hallvors/blog/2009/07/23/browser-js-updates-hotmail-tuenti-aol-webmail" target="_blank">last time</a> I&#039;ll post a changeblog with some background information. (I might spin these posts off to a separate blog at some point but for now it&#039;s here.)
<br>
<br>First, some headlines:
<br><ul class="bullets"><li> Sun System Messenger Express webmail fix.
<br>  </li><li> eBay.fr will no longer hang
<br>  </li><li> Finding a doctor in South Carolina becomes easier, thanks to <a href="/fearphage/" target="_blank">fearphage</a>
<br>  </li><li> Removed patch for maps.live.com - reborn at Bing maps
<br>  </li><li> Conflict between <a href="http://www.salesforce.com/" target="_blank">Salesforce</a> and WebForms2
<br></li></ul>
<br>
<br><h3> Sun System Messenger Express webmail fix.</h3>
<br>
<br>Opera 10 aligns the policy for setting document.domain with the other browsers, and require both pages to set document.domain before allowing communication. (In other words, if www.example.com wants to talk to example.com both of them must set document.domain to &#039;example.com&#039;. In the old implementation, only the content from www.example.com would have to do so).
<br>
<br>Normally, aligning with the other browsers shouldn&#039;t cause problems - but unfortunately, I&#039;ve noticed that certain sites use browser sniffing before setting document.domain! I have <em>no</em> idea why.
<br>
<br>For example, Facebook uses this oddity to avoid setting document.domain in certain older Firefox versions:
<br>
<br><pre>if (navigator &amp;&amp; navigator.userAgent &amp;&amp; document.domain.toLowerCase().match(/(^|\.)facebook\..*/) &amp;&amp; !(parseInt((/Gecko\/([0-9]+)/.exec(navigator.userAgent) || []).pop(), 10) &lt;= 20060508)) { document.domain = window.location.hostname.replace(/^.*(facebook\..*)$/i, &#039;$1&#039;); }</pre>
<br>
<br>I wish I knew why it&#039;s such a bad idea to set document.domain in Firefox-versions released before May 8, 2006.. :sherlock: 
<br>
<br>Similarly, a webmail suite from Sun which is used by big universities and such contains this sniffing:
<br>
<br><pre>var agt=navigator.userAgent.toLowerCase();

var is_nav  = ((agt.indexOf(&#039;mozilla&#039;)!=-1) &amp;&amp; (agt.indexOf(&#039;spoofer&#039;)==-1)
            &amp;&amp; (agt.indexOf(&#039;compatible&#039;) == -1) &amp;&amp; (agt.indexOf(&#039;opera&#039;)==-1)
            &amp;&amp; (agt.indexOf(&#039;webtv&#039;)==-1) &amp;&amp; (agt.indexOf(&#039;hotjava&#039;)==-1));
var is_gecko = (agt.indexOf(&#039;gecko&#039;) != -1);

if(is_nav || is_gecko) document.domain = document.domain
//document.domain = document.domain</pre>
<br>
<br>and they run right into the new security policy when the sniffing means they avoid setting document.domain and all sorts of things break.
<br>
<br>To solve this, <strong>each time we&#039;re about to run a script named setdomain.js or load a file named sample_lr.html - on any website - Opera will first append &quot;Gecko&quot; to its navigator.userAgent string</strong>. Oh, the weird and whacky things you need to do for compatibility.
<br>
<br>  <h3>eBay.fr will no longer hang</h3>
<br>
<br>eBay.fr uses the SELECT.remove() method, but with element nodes instead of numbers as arguments. Their spec violation, our problem. This will be fixed in core, to allow using remove() for OPTION nodes like other browsers do - meanwhile, browser.js will sort it out for eBay.
<br>
<br><h3>Finding a doctor in South Carolina becomes easier</h3>
<br>Do I have any readers in South Carolina? Thanks to <a href="/fearphage/" target="_blank">fearphage</a>&#039;s neat emulation of IE&#039;s bugfeature which lets you find a named form element with document.getElementById(), you can now use <a href="https://www3.bcbssc.com/healthcarefinder/webpages/healthCareFinder_frames.html?title=Doctor+%26amp%3B+Hospital+Finder" target="_blank">Blue Cross Doctor and Hospital Finder</a> even though it relies on IE&#039;s violations against the DOM standard. The patch has been waiting while we were trying to get through to someone at Blue Cross Blue Shield who might be able to fix it, time is up - and big thanks to fearphage!
<br>
<br><h3>Removed patch for maps.live.com</h3>
<br>
<br>Now maps.live is Bing Maps. No point in applying patches for the old hostname anymore.
<br>
<br><h3>Conflict between <a href="http://www.salesforce.com/" target="_blank">Salesforce</a> and WebForms2 / HTML5</h3>
<br>
<br>A report wizard inside Salesforce.com fails in Opera because of our support for the <a href="http://www.whatwg.org/specs/web-forms/current-work/#fetching-data" target="_blank">data</a> attribute from WebForms2.
<br>
<br>When they do
<br>
<br><pre>&lt;select id=&quot;typeSelector&quot; name=&quot;type&quot; onchange=&quot;fillSelectFromArray(document.report_select.rep, ((this.selectedIndex == -1) ? null : data[document.getElementById(&#039;typeSelector&#039;).selectedIndex]));&quot; title=&quot;Report Type Category&quot;&gt; </pre>
<br>
<br>&quot;data&quot; doesn&#039;t refer to the global variable data but to the data property on the SELECT object due to the scope of the event handler.
<br>
<br>This attribute has since been removed from HTML5 so Opera will drop it at some point. Meanwhile, another stopgap site patch makes Salesforce work.
<br>
<br>The 9sky.com fix in the previous edition was also about a problem caused by HTML5. <strong>Standards development and experimental implementations is obviously a major compatibility risk</strong>. If we want to improve the web&#039;s underlying technologies there isn&#039;t any other way forward, though.</div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}i:8;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:87:"
    <div lang="en" dir="ltr">browser.js updates: Hotmail, Tuenti, AOL Webmail</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:25:" Hallvord R. M. Steen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:50:"http://my.opera.com/hallvors/blog/show.dml/4172804";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:41:"http://my.opera.com/hallvors/blog/4172804";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2009-07-23T16:57:13Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:100:"<div lang="en" dir="ltr">Quick overview of browser.js updates during the last couple of weeks.</div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}i:9;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:70:"
    <div lang="en" dir="ltr">Most expensive javascript ever?</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:25:" Hallvord R. M. Steen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:50:"http://my.opera.com/hallvors/blog/show.dml/4163177";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:41:"http://my.opera.com/hallvors/blog/4163177";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2009-07-20T12:15:51Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:2095:"<div lang="en" dir="ltr">I&#039;ve wanted to tell this story for a while, and I don&#039;t think I&#039;m spilling any beans or disclosing any sensitive information at this point.
<br>
<br>So, a while ago Opera Software needed more servers. Not just a few servers either - we were planning <a href="http://www.operamini.com/" target="_blank">Opera Mini</a>&#039;s growth, implementing <a href="http://www.opera.com/link/" target="_blank">Opera Link</a>, and <a href="http://my.opera.com/" target="_blank">My Opera</a> was also growing quickly. We predicted crazy server load increases for the foreseeable future (and man, <a href="http://www.opera.com/smw/" target="_blank">were we right</a>!)
<br>
<br>Clearly we needed to make a massive investment on the server capacity front (basically buying <a href="http://www.digi.no/504306/her-kjores-egentlig-opera-mini&amp;bid=3" target="_blank">these shiny things</a> and then some.)
<br>
<br>Management put a hefty check on the table - I&#039;m sure our beloved sysadmins felt like kids before Christmas - and salivating sales people from major hardware vendors grabbed our requirements spec, dived into their CRMs and crunched their spreadsheets. They emerged with offers and sample servers shipped all the way to Oslo for our testing pleasure.
<br>
<br>However, one of the world&#039;s biggest hardware vendors - whose name every single reader will be familiar with, and whose hardware a good share of you will be using right now - apparently didn&#039;t do their homework. When Opera&#039;s sysadmin booted up the server to test its web-based administration interface, they came across a single JavaScript statement that managed to piss off everyone up to and including the CTO.
<br>
<br><strong>This single statement, apparently written by some sub-contractor they had outsourced admin interface programming to, cost them millions of NOK in lost sales.</strong>
<br>
<br>And the code they sent all the way to Oslo for testing? Here&#039;s an extract:
<br>
<br><pre>if (is.opera)
{
window.location.href=&quot;config/error.htm&quot;;
}</pre></div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}i:10;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:75:"
    <div lang="en" dir="ltr">Facebook monitors your alert() usage</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:25:" Hallvord R. M. Steen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:50:"http://my.opera.com/hallvors/blog/show.dml/4151978";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:41:"http://my.opera.com/hallvors/blog/4151978";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2009-07-16T13:31:28Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:689:"<div lang="en" dir="ltr">If you use a bookmarklet on Facebook and it calls window.alert(), it doesn&#039;t quite do what you expect. They&#039;ve re-defined the entire alert() method - it will pop up a box, but it will also behind the scenes send what you tried to pop up to the server!?! Look at Facebook&#039;s alert code (shown in an appropriate setting, of course):
<br>
<br><span class="imgcenter"><img alt="" src="http://files.myopera.com/hallvors/blog/fbalert.png"></span> 
<br>
<br>Since I routinely use alert() for debugging, should I be paranoid now?
<br>I really wonder what this feature is intended for and whether they actually harvest this data and use it for anything.</div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}i:11;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:92:"
    <div lang="en" dir="ltr">&#039;ESPN FLASH detection system&#039; meets Flash 0</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:25:" Hallvord R. M. Steen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:50:"http://my.opera.com/hallvors/blog/show.dml/3890878";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:41:"http://my.opera.com/hallvors/blog/3890878";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2009-06-29T16:16:30Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:2919:"<div lang="en" dir="ltr">Even in the classy company of bad version detection scripts we&#039;ve met since we started testing Opera 10, <a href="http://static.espn.go.com/ivp/flash.js" target="_blank">this Flash detection</a> approach stands out. That script goes to great effort to require an update every.single.time Adobe releases another Flash version.
<br>
<br>It starts with a bold claim to be the ESPN &quot;Flash detection <strong>system</strong>&quot;, no less:
<br>
<br><pre>// Author: Danny Mavromatis
// Version: 2.07.0
// Created: 10/29/2001
// Updated: 3/6/2006
// ESPN.com FLASH detection system
	var f2 = false;
	var f3 = false;
	var f4 = false;
	var f5 = false;
	var f6 = false;
	var f7 = false;
	var f8 = false;
	var f9 = false;</pre> 
<br>Look at all those variables. What might they be used for? Read on:
<br>
<br><pre>
var fD = navigator.plugins[&quot;Shockwave Flash&quot; + isVersion2].description;
var fV = parseInt(fD.charAt(fD.indexOf(&quot;.&quot;) - 1));
</pre>
<br>So, first it extracts one single letter that precedes a dot in the plugin&#039;s description of itself. This is presumably the plugin&#039;s major version number, you know the 8 in &quot;<strong>8</strong>.0&quot;, the 9 in &quot;<strong>9</strong>.0&quot;, and, um, the 0 in &quot;1<strong></strong>.0&quot;. Then:
<br><pre>
f2 = fV == 2;
f3 = fV == 3;
f4 = fV == 4;
f5 = fV == 5;
f6 = fV == 6;
f7 = fV == 7;
f8 = fV == 8;
f9 = fV == 9;
</pre>
<br>
<br>..it just sets the corresponding &quot;f&quot;-variable to true. If the major version was 8, f8 will be true and so on. A great way to make sure the code will require maintenance - new variables for each new version. And then comes the real gem:
<br>
<br><pre>for (var i = 2; i &lt;= mV; i++) {
if (eval(&quot;f&quot; + i) == true) aV = i;
}
// alert(&quot;version detected: &quot; + aV);</pre>
<br>
<br>
<br>Let&#039;s see, we just had a variable fV which contained Flash&#039;s major version number (or at least its least significant digit) - but this script has severe amnesia. What <strong>was</strong> that number again? Better use a loop and <strong>8 eval() calls</strong> to check the value of that variable. You never know, do you?
<br>
<br>Now, dear readers - Mr. Mavromatis clearly needs some help with this code. Obviously, complexity and maintenance requirements are among his design goals. The natural question is whether there are good, non-obvious ways this script could be improved to be more complex and require even more maintenance? Suggestions welcome in comments.
<br>
<br><strong>Update: Danny Mavromatis responded in comments and - though he no longer works on the ESPN site - has made sure that the page where we found this problem has been updated.</strong> Kudos to Mr. Mavromatis for his quick response and sense of responsibility. I wish more web developers would act this way!
<br>
<br><strong>No more personal attacks, please!</strong></div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}i:12;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:86:"
    <div lang="en" dir="ltr">the day supporting document.onload became a bug</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:25:" Hallvord R. M. Steen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:50:"http://my.opera.com/hallvors/blog/show.dml/3269555";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:41:"http://my.opera.com/hallvors/blog/3269555";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2009-05-20T14:34:16Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:3993:"<div lang="en" dir="ltr">Like many things on the web, the load event seems simple. It originates from the web&#039;s stone age - supported by Netscape 2 in 1996 and fired billions and billions of times since. It&#039;s probably the most widely used event for web scripting. Can it have secrets or quirks after so many years? 
<br>
<br>You might think you could write a one-sentence spec for it, along the lines of &quot;when the document is done loading, dispatch a load event to any listeners created from BODY onload attributes, window.onload property or addEventListener(&#039;load&#039;) calls&quot; - and implement it interoperably in a few hours on top of an otherwise solid DOM/JS core.
<br>
<br><strong>Simplicity is deception.</strong> Actually, the cool thing about the load event is that it seems so simple but is so weird.
<br>
<br>Discovering what I didn&#039;t know about the load event started at the white &quot;please wait&quot; box that covers the contents on <a href="http://www.grainger.com/" target="_blank">grainger.com</a> (this site is now patched in browser.js)
<br>
<br><span class="imgcenter"><img alt="" src="http://files.myopera.com/hallvors/blog/grainger.png"></span>
<br>
<br>I noticed that they did something like 
<br><pre>
document.onload=function(){
// code that shows the &quot;please wait&quot; box, an obvious mistake
}
.
.
&lt;body onload=&quot;&quot;&gt;
</pre>
<br>
<br>Aha: if you assign a listener for the document&#039;s load event but afterwards have an empty onload attribute on body, document.onload will be removed when the browser sees onload=&quot;&quot;. Right? I wrote a test case confirming that assumption and moved on to the next bug. 
<br>
<br>However, colleague Ola was also looking at the bug and could prove that the onload=&quot;&quot; was a red herring. Removing it made no difference. Assigning anything to document.onload was a no-op in all other browsers. <i>What??</i> How come we never noticed that?
<br>
<br>So, we got a developer to remove document.onload support. I wanted it fixed by just ignoring assignments to document.onload, but being a thorough person Daniel made sure document would no longer be an event target for the load event.
<br>
<br>To my consolation I wasn&#039;t the only person saying <i>that must be wrong!</i> This fix makes <strong>document.addEventListener(&#039;load&#039;...)</strong> a no-op too. We&#039;re <i>absolutely</i> sure document.addEventListener(&#039;load&#039;...) must keep working. The DOM Events spec doesn&#039;t say much about the load event, but it sort of <i>implies</i> sending it to the document.  Besides, not sending load events to document anymore broke opera:config and dozens of browser.js patches.
<br>
<br>Then we wrote another test case or two.
<br>
<br>And it&#039;s true. <strong>No browser (except Opera) sends load events to &quot;document&quot;</strong>! They all skip document and go straight for window. BODY onload=&quot;&quot; creates listeners on window, not on body. Even though event.target is the document, the event itself avoids the document like it had swine flu or something. 
<br>
<br><strong>I assume it&#039;s been like that since 1996 and we never thought of testing that in other browsers before.</strong> Wow.
<br>
<br>So, early afternoon on May 12th 2009, our support for document.onload turned from a feature into a bug. Good bye to the possibility of capturing all load events inside a document with a capturing listener (won&#039;t work with window.addEventListener because <a href="http://my.opera.com/hallvors/blog/2006/12/23/firechicken" target="_blank">Mozilla turned out to be a chicken and not a dinosaur</a>). <strong>Edit: luckily I was wrong here, see comments.</strong>
<br>
<br>Actually it feels a bit .. evil .. to suddenly turn around and kill an old feature that&#039;s been with us for years, just because it&#039;s required for web compatibility. Oh well. At least I can confirm that you learn something old every day..</div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}i:13;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:86:"
    <div lang="en" dir="ltr">Site patching article on the core concerns blog</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:25:" Hallvord R. M. Steen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:50:"http://my.opera.com/hallvors/blog/show.dml/3130549";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:41:"http://my.opera.com/hallvors/blog/3130549";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2009-04-07T23:04:26Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:317:"<div lang="en" dir="ltr">If you follow this blog, little in <a href="http://my.opera.com/core/blog/show.dml/3130540" target="_blank">my new article</a> on the <a href="http://my.opera.com/core/" target="_blank">Core Concerns blog</a> will be news to you. Nevertheless you might find it interesting. Have a look.</div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}i:14;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:71:"
    <div lang="en" dir="ltr">websites playing timing roulette</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:25:" Hallvord R. M. Steen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:50:"http://my.opera.com/hallvors/blog/show.dml/3033153";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:41:"http://my.opera.com/hallvors/blog/3033153";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2009-03-07T00:01:03Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:4680:"<div lang="en" dir="ltr">For a couple of days in November, the <a href="http://www.nytimes.com" target="_blank">New York Times</a> looked serenely white in Opera:
<br><span class="imgcenter"><img alt="" src="http://files.myopera.com/hallvors/blog/nytimes.com.png"></span>
<br>
<br>You might think that nothing newsworthy was happening on the planet. Unfortunately it was not the start of a new and peaceful world order, it was merely their JavaScript playing <strong>timing roulette</strong>:
<br>
<br><pre>if (typeof callback == &#039;function&#039;) { 
if (document.addEventListener) { 
  window.setTimeout(function(){ 
    document.write(&#039;&lt;script type=&quot;text/javascript&quot; charset=&quot;utf-8&quot;&gt;(&#039; + callback.toString() + &#039;)();&lt;\/script&gt;&#039;); 
  }, 0) 
}</pre>
<br>What is that doing? This code says &quot;have a 0 millisecond break, then add this SCRIPT tag to the document&quot;. (By &quot;0 millisecond&quot; it sort of means &quot;as soon as you get around to it&quot;.) The problem with that is that <i>if</i> the browser happens to complete loading the document before running that document.write() statement it will <strong>replace</strong> the current document with a single, invisible SCRIPT tag.
<br>
<br>Opera, doing its best at trying to show you the page as soon as possible <i>did</i> finish loading the document before getting back to the timeout - so the page was overwritten and disappeared.
<br>
<br>Now, by the above it sounds like it is a drawback to be fast (<a href="http://my.opera.com/hallvors/blog/2006/11/15/web-speeding-ticket" target="_blank">again?</a>). Wait until you see an extract of some code that broke image upload on <a href="http://www.orkut.com" target="_blank">Orkut</a>:
<br>
<br><pre>&lt;head&gt;
&lt;script&gt;setTimeout( function(){ document.body.appendChild(el) }, 0 )&lt;/script&gt;
&lt;script&gt;/*other stuff here*/&lt;/script&gt;
&lt;/head&gt;&lt;body&gt;
</pre>
<br>
<br>In this case, if the timeout runs before we&#039;ve seen the BODY tag - it will break, because no document.body exists yet. Wait, at New York Times parsing quickly was a <i>mistake</i> and here..we&#039;re punished because we <i>didn&#039;t</i> get to BODY yet when running the timeout?? So we&#039;re simultaneously too fast for NYTimes and too slow for Orkut.. 
<br>
<br>This is JavaScript timing roulette - such things happen when websites are written according to the timing of specific browsers, or even the speed of the network connection the web site developer uses! What would happen if you&#039;re visiting Orkut on a really slow connection and the network has a small hiccup-pause between HEAD and BODY? By Orkut&#039;s code I would not be surprised if certain network delays - only a few milliseconds - would break the site entirely.
<br>
<br>And it gets worse. <a href="http://www.aol.com" target="_blank">AOL</a> sites often try to launch slideshows in popup windows. In Opera that doesn&#039;t go very well:
<br> 
<br><span class="imgcenter"><img alt="" src="http://files.myopera.com/hallvors/blog/aolpopup.png"></span> 
<br>
<br>AOL is another gambler addicted to playing the timing roulette. Bear with me, because this gets complex - but they have something like
<br>
<br><pre>&lt;SCRIPT src=&quot;http://www.aolcdn.com/ke/swfobject/ke_kit_popup_includes.js&quot; type=&quot;text/javascript&quot; language=&quot;javascript&quot; charset=&quot;utf-8&quot;&gt;&lt;/SCRIPT&gt; 
    &lt;DIV id=&quot;gallery-holder&quot;&gt; 
       &lt;DIV id=&quot;news-news_popup_foobar&quot;&gt;</pre>
<br>
<br>The popup_includes.js contains code that appends external scripts to HEAD. The final external scripts (ke_kit_refresh.js) contains further inline code that calls rederPopupPage() which calls a method in the opener window that eventually calls the embedswf() method which starts looking for the element with the ID &quot;news-news_popup_foobar&quot; (where &#039;foobar&#039; is actually the short name for the article).
<br>
<br>Since loading scripts block parsing, we have not yet reached the DIV when the slideshow is supposed to be inserted. So when the script asks &quot;do you have the element news-news_popup_foobar?&quot; Opera responds &quot;no, not yet anyway&quot; and the script just gives up.
<br>
<br>So, apparently we&#039;re supposed to keep parsing forward while we&#039;re running scripts dynamically added earlier in the DOM?! The <a href="http://www.w3c.org" target="_blank">W3C</a> never told us that, I think. It&#039;s the web&#039;s <a href="http://my.opera.com/hallvors/blog/2006/11/17/being-compatible-with-the-dark-matter-of" target="_blank">dark matter</a> striking again.</div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}i:15;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:68:"
    <div lang="en" dir="ltr">X-Talisman-Compatible: messup</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:25:" Hallvord R. M. Steen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:50:"http://my.opera.com/hallvors/blog/show.dml/3000172";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:41:"http://my.opera.com/hallvors/blog/3000172";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2009-02-22T00:54:36Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:1891:"<div lang="en" dir="ltr">Yikes.
<br>
<br>I&#039;m seeing <a href="http://alistapart.com/articles/beyondDOCTYPE" target="_blank">X-UA-Compatible</a> abuse everywhere these days. It seems most of the big sites I look at have decided not to give the IE8 team half a chance to iron out their bugs, they&#039;ve all simply decided to close their eyes and slap on a &quot;behave like IE7&quot; instruction instead. Guess if this is going to cause compat problems down the road when all non-IE browsers are forced to look at the META tags and figure out if they should be bug-compatible with IE7, 8 or 9 for any given site.. :-(
<br>
<br>Here&#039;s a funny offender: <a href="http://www.adobe.com" target="_blank">adobe.com</a> insists that if I&#039;m going to show their &quot;flashAbout_info_small.swf&quot; animation correctly, then .. 
<br>
<br>GET /swf/software/flash/about/flashAbout_info_small.swf HTTP/1.0
<br>Host: www.adobe.com
<br>Referer: <a href="http://www.adobe.com/products/flash/about/" target="_blank">http://www.adobe.com/products/flash/about/</a>
<br>
<br>HTTP/1.1 200 OK
<br><strong>X-UA-Compatible: IE=7
<br>Content-Type: application/x-shockwave-flash</strong>
<br>Date: Sat, 21 Feb 2009 23:39:33 GMT
<br>Content-Length: 594
<br>
<br>... I have to render the .swf <strong>like IE7 would</strong>. 
<br>
<br>No problems, Adobe. Since I work for a <a href="http://www.opera.com/" target="_blank">browser vendor</a> the server&#039;s wish should be my command. Here&#039;s your <a href="http://www.adobe.com/swf/software/flash/about/flashAbout_info_small.swf" target="_blank">about Flash</a> SWF rendered by IE in IE7 compat mode:
<br>
<br><span class="imgcenter"><img alt="" src="http://files.myopera.com/hallvors/blog/flash-compat-view.png"></span>
<br>
<br>Beautifully compatible, no? Thanks for the X-UA-Compatible hint, I would never have figured that out on my own!</div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}i:16;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:57:"
    <div lang="en" dir="ltr">Dragonfly articles</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:25:" Hallvord R. M. Steen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:50:"http://my.opera.com/hallvors/blog/show.dml/2952321";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:41:"http://my.opera.com/hallvors/blog/2952321";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2009-02-03T20:32:17Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:465:"<div lang="en" dir="ltr">Two tutorials on using Opera Dragonfly (and other debuggers) by yours truly are out: <a href="http://thinkvitamin.com/dev/same-dom-errors-different-browser-interpretations/" target="_blank">debugging DOM issues</a> on thinkvitamin.com and the brand new <a href="http://alistapart.com/articles/advanceddebuggingwithjavascript" target="_blank">advanced JavaScript debugging</a> on A List Apart. Hope you&#039;ll find them worth reading.</div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}i:17;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:88:"
    <div lang="en" dir="ltr">Taleo - The Leader in On Demand Unbalanced Quotes</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:25:" Hallvord R. M. Steen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:50:"http://my.opera.com/hallvors/blog/show.dml/2912800";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:41:"http://my.opera.com/hallvors/blog/2912800";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2009-01-18T04:15:15Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:3863:"<div lang="en" dir="ltr">Load <a href="http://www.getacooljob.com" target="_blank">getacooljob.com</a> in Opera, see <a href="http://aac.taleo.net/servlets/CareerSection?art_ip_action=FlowDispatcher&amp;flowTypeNo=13&amp;pageSeq=1&amp;art_servlet_language=en&amp;csNo=2'%3E%3C/head%3E%3Cbody%20bgcolor= " target="_blank">error page</a> (http://aac.taleo.net/servlets/CareerSection?art_ip_action=FlowDispatcher&amp;flowTypeNo=13&amp;pageSeq=1&amp;art_servlet_language=en&amp;csNo=2&#039;%3E%3C/head%3E%3Cbody%20bgcolor=). At first sight it might look like a standard browser sniffer saying &quot;go away and don&#039;t dare becoming our customer until you&#039;ve found a browser we like&quot;... until you look a bit closer at that address. See the junk at the end?
<br>
<br><strong>&amp;csNo=2&#039;%3E%3C/head%3E%3Cbody%20bgcolor=</strong> decodes to <pre>&amp;csNo=2&#039;&gt;&lt;/head&gt;&lt;body bgcolor=</pre> and it&#039;s caused by the lack of a closing quote for the META tag&#039;s content attribute on the previous page:
<br>
<br><pre>&lt;META HTTP-EQUIV=&quot;refresh&quot; content=&quot;01; url=&#039;http://aac.recruitsoft.com/servlets/CareerSection?art_ip_action=FlowDispatcher&amp;amp;flowTypeNo=13&amp;amp;pageSeq=1&amp;amp;art_servlet_language=en&amp;amp;csNo=2&#039;&gt;</pre>
<br>
<br>The site apparently belongs to <a href="http://www.taleo.com/" target="_blank">Taleo</a> which is the &quot;Leader in On Demand Talent Management&quot;. As they aren&#039;t talented enough to balance their quotes or use a validator to spot markup mistakes, the level of hype obviously exceeds their technical competence.. 
<br>
<br>See also statements like &quot;this Career Section does not allow the use of the BACK or FORWARD browser buttons during the application process&quot; (<a href="http://www.taleo.com/support/" target="_blank">source</a>), the hideous sniffing here
<br><pre>function stopEvent() {
var userAgent = window.navigator.userAgent;
var appName = window.navigator.appName;
if ((appName.indexOf(&quot;Explorer&quot;) &gt;= 0) &amp;&amp; (userAgent.indexOf(&quot;Mozilla/3&quot;) &gt;= 0) &amp;&amp; (userAgent.indexOf(&quot;Mac&quot;) &gt;= 0)) {
return (true);
} else {
return (false);
}
}</pre>
<br>and their &quot;anti-multiple-tabs&quot; JavaScript <pre>//---------------------------------------------------------------------
// This method increments the count of browser using the career section
// on the current session in the document&#039;s cookie.
// This code is inserted only when IE browser is used
//---------------------------------------------------------------------
function setMultiBrowserDetection()
{
if (window.navigator.cookieEnabled)
{
// The multibrowser problem doesn&#039;t occur where cookies are not available
var cs_cnt = -1;
var index = document.cookie.indexOf(&quot;cs_cnt&quot;);
var countbegin = -1;
var countend = -1;
if (index == -1)
{
cs_cnt = 1;
}
else
{
countbegin = (document.cookie.indexOf(&quot;=&quot;, index) + 1);
countend = document.cookie.indexOf(&quot;;&quot;, index);
if (countend == -1)
{
countend = document.cookie.length;
cs_cnt = eval(document.cookie.substring(countbegin, countend));
}
else
{
if (countend &lt; countbegin)
{
cs_cnt = 0;
}
else
{
cs_cnt = eval(document.cookie.substring(countbegin, countend));
}
}
if (cs_cnt &lt; 1)
{
cs_cnt = 1;
}
else
{
cs_cnt = cs_cnt + 1;
}
}
document.cookie = &quot;cs_cnt=&quot;+cs_cnt;
if (cs_cnt &gt; 1)
{
// More than one browser is using the current session
window.document.location = &quot;http://aac.taleo.net/servlets/CareerSection?art_ip_action=MultipleBrowserConflict&quot;;
}
}
}
</pre> complete with eval() instead of parseInt() (meaning that anyone who can get a cookie set on this site can XSS them).. When you stop shaking your head, I&#039;d like you to opine on how much less talented a web site could possibly get..
<br></div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}i:18;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:77:"
    <div lang="en" dir="ltr">Google Maps vs. DOM2 specification 1-0</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:25:" Hallvord R. M. Steen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:50:"http://my.opera.com/hallvors/blog/show.dml/2886958";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:41:"http://my.opera.com/hallvors/blog/2886958";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2009-01-08T04:06:38Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:5952:"<div lang="en" dir="ltr">Since users <a href="http://my.opera.com/community/forums/topic.dml?id=261219" target="_blank">reported</a> that seeing saved addresses and getting directions on <a href="http://maps.google.com" target="_blank">Google Maps</a> was broken in Opera I had to do some digging. Actually a lot of digging. Eventually, I ended up here:
<br>
<br><pre>xO.Tia=function(a){if(!a||a==window||!a.hasOwnProperty||xO.uSa(a))return xO.Type.NATIVE;if(xO.jTa(a))return xO.Type.PROTO;if(a.constructor===Function)return xO.Type.FUNCTION;if(a.constructor===Array)return xO.Type.ARRAY;if(a.constructor===Object)return xO.Type.OBJECT;return xO.Type.NATIVE};</pre>
<br>..which in its unwrapped and scrambled glory is a method to figure out what sort of object &quot;a&quot; is. The bit we didn&#039;t handle like Maps expected was:
<br><pre>if(a.constructor===Object)return xO.Type.OBJECT;</pre>
<br>If you pass a DOM node to this function that if clause is true and it will conclude that it is of type &quot;Object&quot;. Further along there was some logic detecting that this node was an Object and thus not able to have event listeners. 
<br><span class="imgright"><img alt="" src="http://files.myopera.com/hallvors/blog/gmsavedplaces.jpg"></span> 
<br>So, no event listener is added and nothing at all happens when clicking the triangle to view your search history:
<br>
<br>
<br>In Firefox, a node&#039;s constructor property points to the corresponding DOM2 HTML interface. To explain that in real English, the <a href="http://www.w3.org/TR/DOM-Level-2-HTML/" target="_blank">DOM 2 HTML</a> specification says that for each element in HTML (BODY, A, DIV, P and so on) there should be a JavaScript object named <strong>window.HTML+name of element+Element</strong> (HTMLBodyElement, HTMLAnchorElement, HTMLDivElement, HTMLParagraphElement <a href="http://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-798055546" target="_blank">and so on</a>). 
<br>
<br>What&#039;s the point of that? These are &quot;prototypes&quot; of the DOM. Through JavaScript&#039;s prototype inheritance feature you can add properties and methods to for example HTMLDivElement.prototype and all DIVs in your document will appear to have those properties and methods. For example
<br><pre>HTMLDivElement.prototype.getExternalLinks = function(){
    for(var list=[],links=this.getElementsByTagName(&#039;a&#039;),l,i=0;l=links[i];i++)
        if((new RegExp( &quot;https?:\/\/(?!&quot;+location.hostname+&quot;)&quot; )).test(l.getAttribute(&#039;href&#039;)))list.push(l);
    return list;
}</pre>
<br>lets you call div.getExternalLinks() for any DIV in your DOM to list the anchors inside that DIV that point to a an external URL. Or maybe you want an isExternalLink() method on A nodes instead? No problem:
<br><pre>HTMLAnchorElement.prototype.isExternalLink = function(){
    return (new RegExp( &quot;https?:\/\/(?!&quot;+location.hostname+&quot;)&quot; )).test(this.getAttribute(&#039;href&#039;));
}</pre>
<br>As you see, the DOM2 HTML standard gives you quite a lot of power to extend the DOM.
<br>
<br>Back to our problem. When Google Maps in Firefox looks at div.constructor it points to the HTMLDivElement object.
<br>
<br>In Opera, it points to window.Object.
<br>
<br>The obvious question is: <strong>is Opera wrong?</strong>
<br>
<br>The answer: No. We are <i>perfectly</i> standards-compliant. We follow <a href="http://bclary.com/2004/11/07/#a-4.3.4" target="_blank">ECMAScript 2.62 4.3.4 Constructor property spec</a>, <a href="http://www.w3.org/TR/DOM-Level-2-Core/core.html" target="_blank">DOM2 Core</a>, and <a href="http://www.w3.org/TR/DOM-Level-2-HTML/" target="_blank">DOM 2 HTML</a>.
<br>
<br>The problems is: <strong>none of these specifications really cover what the constructor property of a DOM node should return</strong>.
<br>
<br>Opera and Google Maps compatibility is a victim of spec fragmentation. The <a href="http://www.w3.org/DOM/DOMTR" target="_blank">DOM specifications over there</a> are not sufficiently aware of the details in <a href="http://www.ecma-international.org/publications/standards/Ecma-262.htm" target="_blank">that other spec over there</a> to cover the issue.
<br>
<br>The funny thing is that the <a href="http://lists.w3.org/Archives/Public/public-html/" target="_blank">public-html</a> mailing list has had <a href="http://lists.w3.org/Archives/Public/public-html/2008Nov/0108.html" target="_blank">loooong-winded</a> <a href="http://lists.w3.org/Archives/Public/public-html/2008Nov/0369.html" target="_blank">discussions</a> where a vocal group argued that the HTML5 spec was too comprehensive and should be split into multiple stand-alone specifications.
<br>
<br>Looking beyond the &quot;what <strong>I&#039;m</strong> not interested in should not be in the spec&quot; shoot-out, they have a point: the spec as-is might not be &quot;reviewer-friendly&quot; to someone who, for example, is only interested in discussing the semantics of the HTML language. (&quot;Spec reviewers&quot; are completely ignored in the <a href="http://www.w3.org/TR/html-design-principles/#priority-of-constituencies" target="_blank">HTML5 &quot;priority of constituencies&quot; design principle</a>).
<br>
<br>However, fragmenting the spec increases the risk of dropping another &quot;constructor&quot; underspecified on the floor. Google Maps basically found an omission in <a href="http://www.w3.org/TR/DOM-Level-2-Core/ecma-script-binding.html" target="_blank">DOM2&#039;s ECMAScript bindings</a>. Opera simply followed the spec and implemented the omission..
<br>
<br>Let&#039;s do whatever it takes to make the next HTML spec comprehensive enough. To quote Jamie Zawinski: &quot;your needs are big because the Internet is big&quot;. So fasten your seat belts, HTML5 will be huge, it&#039;ll be complex, it&#039;ll have the weird DOM bits and parser bits - and those bits are necessary to make it a really solid specification.</div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}i:19;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:52:"
    <div lang="en" dir="ltr">10 is the one</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:25:" Hallvord R. M. Steen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:50:"http://my.opera.com/hallvors/blog/show.dml/2834389";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:41:"http://my.opera.com/hallvors/blog/2834389";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2008-12-19T00:29:51Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:3935:"<div lang="en" dir="ltr">So we&#039;re busy preparing the major upgrade from 9.5x and 9.6x - and what&#039;s more obvious than calling it Opera 10? What&#039;s in a name, or a version number?
<br>
<br><strong>Apparently a lot of trouble.</strong>
<br>
<br>As <a href="http://my.opera.com/Andrew%20Gregory/blog/2008/05/11/opera-10-is-too-old" target="_blank">Andrew Gregory already noticed</a>, we&#039;re the first browser ever to release with a two-digit version number. If websites assume that version numbers always have a one-letter &quot;major&quot; part and look for a single digit, they are going to &quot;detect&quot; Opera 1!
<br>
<br>Since we released the first preview of Opera 10, we&#039;re seeing the bug reports come in. Web sites go belly up because of their bad sniffing. Some of them aren&#039;t even ashamed of it.. 
<br>
<br><span class="imgcenter"><img alt="" src="http://files.myopera.com/hallvors/blog/BoA.png"></span>
<br>
<br>Thanks, Bank of America. Do you feel like it&#039;s 1995 again? Yeah, me too.
<br>
<br>You&#039;d think that with the intense development Microsoft has been lavishing on live.com they would have found somebody capable of writing a usable browser sniffer (or <strong>ideally</strong> a person clever enough to say &quot;wait, we don&#039;t really need one - what if we just use feature detection instead?&quot;). Think again..
<br><span class="imgcenter"><img alt="" src="http://files.myopera.com/hallvors/blog/hotmail.png"></span> 
<br>
<br>..and for further evidence that their backend version detection is an odd piece of software engineering, read their cookies closely - Opera 9.62&#039;s request first, then Opera 10:
<br><pre>GET /mail/browsersupport.aspx 
Host: co109w.col109.mail.live.com 
User-Agent: Opera/9.62 (Windows NT 5.1; U; en) Presto/2.2.0 

Set-Cookie: BrowserSense=Win=1&amp;Downlevel=0&amp;WinIEOnly=0&amp;Firefox=0&amp;Opera=1&amp;OperaVersion=9.2&amp;Safari=0; domain=.live.com; path=/</pre>
<br>
<br><pre>GET /mail/browsersupport.aspx 
Host: co109w.col109.mail.live.com 
User-Agent: Opera/10.00 (Windows NT 5.1; U; en) Presto/2.2.0 

Set-Cookie: BrowserSense=Win=1&amp;Downlevel=1&amp;WinIEOnly=0&amp;Firefox=0&amp;Opera=1&amp;OperaVersion=&amp;Safari=0; domain=.live.com; path=/</pre>
<br>
<br>Did you spot the missing version value? We really confused them by adding 0.37 to our previous value, didn&#039;t we?
<br>
<br>Speaking of cookies, they are the main reason we added the feature that lets you hide Opera&#039;s identity. Back then in 1996 or so, some sites would do browser sniffing and send cookies only to known browsers. On the next page, if you didn&#039;t serve it cookies the site would say &quot;hey, you don&#039;t support cookies so go away&quot;. What would <a href="http://en.wikipedia.org/wiki/Joseph_Heller" target="_blank">Joseph Heller</a> make of that, I wonder?
<br>
<br>So, rewind to meet the catch-22 server, re-born at <a href="http://www.banksa.com.au/" target="_blank">Bank South Australia</a>:
<br><pre>GET /InternetBanking/ HTTP/1.1
User-Agent: Opera/9.62 (Windows NT 5.1; U; en) Presto/2.1.1
Host: ibanking.banksa.com.au

HTTP/1.1 200 OK
Set-Cookie: JSESSIONID=000019WTazsWAk-lB38OrmKD3kR:13l3ifhnq;Path=/
Set-Cookie: bhCookieSess=1;Path=/
Set-Cookie: bhCookiePerm=1;Expires=Sat, 20-Dec-2008 23:35:40 GMT;Path=/</pre>
<br>..and Opera 10..:
<br><pre>GET /InternetBanking/ HTTP/1.1
User-Agent: Opera/10.00 (Windows NT 5.1; U; en) Presto/2.2.0
Host: ibanking.banksa.com.au

HTTP/1.1 200 OK
Content-Type: text/html;charset=ISO-8859-1
Content-Language: en-AU
Date: Thu, 18 Dec 2008 23:34:37 GMT
Connection: close</pre>
<br>
<br>Um, I&#039;m hungry. Where are your cookies? Predictably the next page looks like this:
<br>
<br><span class="imgcenter"><img alt="" src="http://files.myopera.com/hallvors/blog/BankSA.png"></span>
<br>
<br>This is probably just the beginning. :(
<br>
<br><strong>Will the web ever learn?</strong></div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}}}}}}}}s:4:"type";i:512;s:7:"headers";a:4:{s:4:"date";s:29:"Sun, 07 Mar 2010 09:36:25 GMT";s:6:"server";s:75:"Apache/2.2.9 (Debian) mod_apreq2-20051231/2.6.0 mod_perl/2.0.4 Perl/v5.10.0";s:12:"content-type";s:20:"application/atom+xml";s:17:"transfer-encoding";s:7:"chunked";}s:5:"build";i:20081219;}