a:4:{s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"feed";a:1:{i:0;a:6:{s:4:"data";s:0:"";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:7:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:55:"
    <div lang="en" dir="ltr">Security @ Opera</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:8:"subtitle";a:1:{i:0;a:5:{s:4:"data";s:39:"
    <div lang="en" dir="ltr"></div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:4:"link";a:2:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:34:"http://my.opera.com/securitygroup/";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:1;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:2:{s:3:"rel";s:4:"self";s:4:"href";s:47:"http://my.opera.com/securitygroup/xml/atom/blog";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:28:"The Opera Security group    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:39:"http://my.opera.com/securitygroup/blog/";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2010-02-18T15:24:35Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:5:"entry";a:6:{i:0;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:80:"
    <div lang="en" dir="ltr">What is a browser security issue, anyway?</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:28:"Yngve Nys√¶ter Pettersen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:55:"http://my.opera.com/securitygroup/blog/show.dml/7934211";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:46:"http://my.opera.com/securitygroup/blog/7934211";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2010-02-18T15:24:35Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:12101:"<div lang="en" dir="ltr">[Note: This is a updated version of the <a href="http://labs.opera.com/news/2006/08/01/" target="_blank">Opera Labs article</a> from 2006]
<br>
<br>A large number of people are looking for security problems and vulnerabilities in Opera and other applications. Some people do not like this, but we think it is fine. When done responsibly, this can increase security for the application and is thus of great benefit to users. However, when done irresponsibly, the activity can cause needless alarm, wasting the time of application vendors and end users.
<br>
<br>An example of irresponsibility is how they report and classify the issues they find, and how the issues are communicated to the application vendor.
<br>
<br>The primary problems we see with some of the reporting is that:
<br><ul class="bullets"><li> Many reports are about problems that may be bugs, even significant stability issues, but they are not really security issues.
<br>  </li><li> Some reports exaggerate the severity of the problem. 
<br>  </li><li> Some reporters do not give us an opportunity to check the problem, verify that it is indeed a security issue, and release a patched version before they publish their findings.
<br></li></ul>
<br>
<br>The terms &quot;security issue&quot; and &quot;vulnerability&quot; cover a large number of serious problems within an application.
<br>
<br>Security real issues list:
<br><ul class="bullets"><li> A real issue makes the application reveal the user&#039;s protected information, such as  file system information, user name, passwords, etc., without authorization.
<br>  </li><li> A real issue makes the application mislead the user about what is going on.
<br>  </li><li> A real issue makes the application execute arbitrary code.
<br>  </li><li> A real issue uses weak protocols when it is possible to use stronger protocols.
<br></li></ul>
<br>
<br>Those are just some of the possibilities. As important is what should NOT be called a security issue.
<br>
<br>Security non-issues list:
<br><ul class="bullets"><li> A non-issue involves crashes that do not prevent the restart of the application, and do not lead to an execution of arbitrary code.
<br>  </li><li> A non-issue involves attacks that permanently disable the application.
<br>  </li><li> A non-issue states that users are not able to access or use their online banking sites, shopping sites, etc. due to site specific problems
<br>  </li><li> A non-issue states that Web sites claim cookies do not work.
<br>  </li><li> A non-issue states that the application uses stricter security protections than another competing application.
<br></li></ul>
<br>
<br>Sometimes, reporters incorrectly classify instances from the non-issues list as issues from the real issues list.
<br>
<br>The two main severity concerns prone to be exaggerated are allegations that a problem &quot;can be used to execute arbitrary code&quot; or is a &quot;Denial of Service&quot; (DOS) attack.
<br>
<br>It seems that the combination of a very large input and a crash leads some people to automatically think the problem may be used to &quot;execute arbitrary code&quot;, that is, take over the user&#039;s computer. That is not always the case, and is usually only possible for what is called a stack buffer overflow, even though it is also sometimes possible for heap (allocated) buffer overflows. However, we have seen this phrase used even for ordinary &quot;NULL pointer&quot; crashes that had no possibility whatsoever to be
<br>abused.
<br>
<br>Another exaggeration is calling any crash that can be triggered by a Web site a &quot;Denial of Service&quot; attack. In our opinion, crashing a server which could potentially be running an important or critical service can rightly be called a Denial of Service, as long as the server is not able to automatically recover. This is because bringing down the server will deny service to all users.
<br>
<br>Crashing a client, while it is an undesirable event and one we want to fix quickly, can only be achieved by enticing the user into accessing a document that crashes the client. Even then it will usually only inconvenience the user long enough to restart the application. That is not sufficient cause to call it a Denial of Service; in most of these cases it is a stability issue.
<br>
<br>The only way, in our opinion, that a crash in a client can be called a Denial of Service is if the attack causes the client to crash again when it is restarted, and when fixing the problem requires more than changing the immediate startup configuration (previous session or blank page). Consequently, this requires editing of the configuration files or a complete re-installation.
<br>
<br>In our opinion, calling a normal crash problem in a client a &quot;Denial of Service&quot; vulnerability is a devaluation of the meaning of the term &quot;Denial of Service&quot;, which eventually may rob it completely of its correct meaning. Much in the same way, the word &quot;hacker&quot; is now considered to mean &quot;computer criminal&quot;, not &quot;highly skilled computer specialist&quot;, which was its original meaning. Please see <a href="http://en.wikipedia.org/wiki/Hacker_(computing)" target="_blank"><a href="http://en.wikipedia.org/wiki/Hacker_(computing)" target="_blank">http://en.wikipedia.org/wiki/Hacker_(computing)</a></a>. One may ask if an attack that disables the client really is a
<br>security problem. After all, it does not compromise the user&#039;s information security, privacy, or the system&#039;s integrity. Generally, we do not consider ordinary crashes, freezes, and other so-called &quot;Denial of Service&quot; attacks security problems; they are stability issues.
<br>
<br>Other browser developers have also seen this kind of exaggeration, and <a href="http://weblogs.mozillazine.org/gerv/archives/2005/10/the_price_of_fa.html" target="_blank">Gerv of Mozilla</a> apparently shares our opinion about calling crashes Denial of Service. While we think <a href="http://blogs.msdn.com/ie/archive/2005/02/08/369119.aspx" target="_blank">Microsoft</a> is stretching the definition of Denial of Service, their situation is a bit more complex, which may justify using the definition in their case.
<br>
<br>We would like to use this opportunity to ask the security research community to revisit and update/clarify the meaning of their classifications for the various contexts where they are used. In particular, those who maintain vulnerability databases should consider the actual severity of a reported problem before posting the information.
<br>
<br>
<br><strong>&quot;I think I have found a security issue in Opera. What should I do?&quot;</strong>
<br>
<br>We recommend: Report it to us before you publish it, so we can fix the problem and release an updated version as soon as possible. We take security seriously, and will investigate all reports.
<br>
<br>You should file the report at <a href="https://bugs.opera.com/wizard/" target="_blank"><a href="https://bugs.opera.com/wizard/" target="_blank">https://bugs.opera.com/wizard/</a></a>, with the severity &quot;Security Issue&quot; and you should fill in all information you have, or suspect, about the problem:
<br>
<br>   * Give a clear and concise explanation of the problem, as complete as possible, including why it is a security issue if that is not obvious.
<br>   * Identify which version(s) of Opera you have tested, including which operating system versions. At least one of the tested versions should be the most recent release for the affected platforms.
<br>   * Document what is needed to replicate the problem with a step-by-step procedure which includes the source code or command line operations.
<br>   * Provide an e-mail address where we can contact you in case we need more information, and to keep you updated about our progress.
<br>   * Provide actual test cases. The test cases should contain only the minimum complexity required to reproduce the problem.
<br>   * Provide references to previous discussions about the problem area, and if it has occurred in other software.
<br>
<br>You should always file a <a href="https://bugs.opera.com/wizard/" target="_blank">bug report</a> about the issue, even if you are going to send information to the Security Group via e-mail (see below). The report will be filed in our system, and it will remain in the system even if your e-mail should go astray.
<br> 
<br>Unless they are very short, the test cases should be attached to the bug report by using the e-mail address you get after you submit the bug report.
<br>
<br>Server-side test cases should, if there are no special reasons to use other formats, be written in Perl, PHP, or Python. Aside from using standard libraries, they must be self contained.
<br>
<br>To protect the data integrity of the test cases, you should PKZip/WinZip (.zip) or Tar/Gzip (.tar.gz) the test cases, even if they are single files.
<br>
<br>If you further wish to protect the test cases you may PGP encrypt them to security (at) opera dot com using the public key below, before attaching them to the bug report.
<br>
<br>We recommend that if you are planning to publish your report, the information you submit to us must at least include <strong>all</strong> the information you are going to publish, preferably more. We have occasionally received reports that contained very limited information as compared to what was eventually published, and therefore it was only after publication we were able to understand the true severity of the problem.
<br>
<br>Allowing the application vendor to fix the issue before publishing the advisory is good for the users of the application. There is no point leaving end users vulnerable to attack. We at Opera will cooperate and verify the advisory; we can also point out if the issue is not exploitable, helping to increase the quality of the advisory. As a matter of principle we always try to give due credit to responsible reporters in our changelogs or press releases.
<br>
<br>Happy, and responsible, hunting!
<br>
<br>
<br>To contact the Opera Security group, send an e-mail to security (at) opera dot com , whose PGP key is below. As noted above, we prefer that Security Issues are reported via our <a href="https://bugs.opera.com/wizard/" target="_blank">Bug tracking system</a>, even if you do send an e-mail about the issue.
<br> 
<br><pre>-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: PGP 8.1
 
mQGiBELOLzkRBADVw74D8uj9bPNzgmfgf9tC72ckgqnxGHrRTMMK9y42XiLXiIYp
B66OjYpPiwgWzNqivcuyhc0HUGHZeezyE1wK4qGZ0cvxYuWrod2B0xyIXcDg6jTt
Vr/KgbfZy1RhLb9CPW3ngH28wbKAGud7dOsCjqvC+RWXAqPzN9ZXT6S3AwCg/+q6
pzhHdFMjvWrmRuWnypwO3mcD/iDbfiKe7c4nJs+yUveVjEkP+2f/zNg/3lSNUjBO
sg9CaXQlC7QCsTLEmDWAmjlebTI/DVlOfnGYa22myj1KLZdx5/uUG0aZUWDMOkKn
MjqLSyFRqb4VwSjetoojGcHob5zJQUeZ3+q4fSt66kWRwxARmnP3fyeHtdt+ddWa
KkMlBACkj3ZjnORHkyFQDru88IcZKgzTuQzhMcYmCp9vd+gMAy4+r3vUEq5EnXeg
ydBVBzReI4bDizjvpwUwbCEOn+ei8n95x2n7DHEjpn2THasb1ENkVfZ1iHi4OnO3
DaqvnXwNhnobEfEEcLjQDvMEjfWx/T1fZ6I1FwXJZr7TzwvJIrQpT3BlcmEgU2Vj
dXJpdHkgR3JvdXAgPHNlY3VyaXR5QG9wZXJhLmNvbT6JAF0EEBECAB0FAkLOLzkH
CwkIBwMCCgIZAQUbAwAAAAUeAQAAAAAKCRB2h/HMa2j6eQKoAKCv6+UWqdumoTjy
bYL5fzdVlUm8BgCdFX2FFnsyd1O9tSszh7JQ20is1065Ag0EQs4vORAIAPZCV7cI
fwgXcqK61qlC8wXo+VMROU+28W65Szgg2gGnVqMU6Y9AVfPQB8bLQ6mUrfdMZIZJ
+AyDvWXpF9Sh01D49Vlf3HZSTz09jdvOmeFXklnN/biudE/F/Ha8g8VHMGHOfMlm
/xX5u/2RXscBqtNbno2gpXI61Brwv0YAWCvl9Ij9WE5J280gtJ3kkQc2azNsOA1F
HQ98iLMcfFstjvbzySPAQ/ClWxiNjrtVjLhdONM0/XwXV0OjHRhs3jMhLLUq/zzh
sSlAGBGNfISnCnLWhsQDGcgHKXrKlQzZlp+r0ApQmwJG0wg9ZqRdQZ+cfL2JSyIZ
Jrqrol7DVekyCzsAAgIH/1nn7DeOo79hX8V3cgGRbHDyw/CC251salCt5gislPdV
RaUAyAC24m2MprPUr6JV6QfmmXgt/FYYbdscREPkbGplXkZFSDlcH8PKfzDDaewG
dApQhOCg4bsFNUX46l/kcooAjlihLZbb9XUJ0IqIvbxJze0NtHD6o7ABTQeEagK+
dL/CBlYxMWG4SvCCol88IjsdkwpCrpIMcnh1lGPMEfvCt86hk96Y1jUouve1sLGx
zx9QbCqo8TkJyi5bJhCGEHS90nEQsdHmaS+Grvm3eep9dTLxhn+Aj/WTpdUy8VD0
rwPAEKWOo4V4HdNEgGjSNOV8LSp8/2wZR0z7zZc3vYeJAEwEGBECAAwFAkLOLzkF
GwwAAAAACgkQdofxzGto+nnZ1ACg9xn8tVb99DfZsC6wRGzr7dtfMU0An1aY3FZ7
k3eRlyzdgO2F+WOHux4J
=w+QX
-----END PGP PUBLIC KEY BLOCK-----
</pre>
<br></div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}i:1;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:116:"
    <div lang="en" dir="ltr">Opera 10.50 alpha version testing fix for TLS Renegotiation Security Problem.</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:28:"Yngve Nys√¶ter Pettersen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:55:"http://my.opera.com/securitygroup/blog/show.dml/6792891";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:46:"http://my.opera.com/securitygroup/blog/6792891";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2010-01-23T14:54:00Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:13649:"<div lang="en" dir="ltr">Early November 2009 the <a href="http://www.ietf.org/" target="_blank">IETF</a> <a href="http://www.ietf.org/dyn/wg/charter/tls-charter.html" target="_blank">Transport Layer Security Working Group</a> (TLS WG) learned of a serious security vulnerability in the SSL/TLS protocol, the &quot;Renego&quot; problem.
<br>
<br>Both TLS servers and clients have the ability to initiate a refresh or complete renegotiation of the encryption parameters used in a TLS connection. This can be used to make encryption keys even less predictable, thus providing less data an attacker can analyze, or as it is frequently used, to ask the users to identify themselves with a client certificate over an already secured connection, thus protecting their personal information better.
<br>
<br>What Marsh Ray discovered in September, and started working with others to fix, and Rex Martin independently discovered about two months later, was that an attacker could use this renegotiation feature to (for example) insert a partial HTTP request to the HTTP server over a connection the attacker established, then start to forward the TLS handshake from the client to the server (over the already established secure connection) and let them establish their own secure connection. The problem is that the server would then combine the attacker&#039;s partial request with the client&#039;s request into a single request controlled by the attacker, and execute the resulting request, e.g. transfer USD 100 000 to another account, but as if the user had approved it. Other variations exists, some involving attacks on the client instead of the server.
<br>
<br>The main cause of the problem is that the server thinks the client renegotiated the connection, as far as the client is concerned it just established the connection, and neither side can tell what the other believed was the state of the connection. Another cause of the problem is that many applications, including HTTPS, are not aware of the renegotiation, and does not have procedures to separated data frome before and after the renegotiation.
<br>
<br>It must be emphasized that this is not a <i>application</i> vulnerability, it is a <i>protocol</i> vulnerability, as far as I know the worst ever to hit the SSL v3 and TLS protocol ever, and it required that all the SSL and TLS protocol specifications be updated.
<br>
<br>This is also a security problem that cannot be fixed by just fixing the client (e.g. Opera), or by just fixing the bank&#039;s server. To be secured against this problem both sides, the client <strong>and</strong> the server must not just be upgraded with the fix, they must be able to tell that the <strong>other</strong> side of the transaction also support the fix.
<br>
<br>After almost two months of extensive discussions in the TLS WG, the rough consensus of the group settled on the following <a href="http://www.rfc-editor.org/rfc/rfc5746.txt" target="_blank">update of all TLS versions</a> (and SSL v3, but they have no authority over that protocol version):
<br>
<br><ul class="bullets"><li>A new TLS Hello Extension, RenegotiationInfo (RI), is added and used to exchange information between the client and the server about the last TLS handshake done on the currently active connection, which they use to confirm that they are in agreement about the state of the connection they are renegotiating. In the first negotiation of the connection the RI extension contain no data, it is empty. This exchange of information in combination with how TLS secures its hasnshake negotiation, cryptographically binds the current encrypted state of the connection with the next state of the connection, preventing a man in the middle attack.
<br>  </li><li>As some servers does not properly support TLS Extensions, particularly SSL v3 servers, a special Signaling Cipher Suite Value (SCSV) can be sent by the client to the server to indicate that it supports the RenegotiationInfo extension. A patched server must then respond as if the client sent an empty RI extension, and return an empty RI extension, or abort the connection if it sees that the connection is being renegotiated while the client thinks it is establishing a connection. 
<br></li></ul>
<br>
<br>In <a href="http://my.opera.com/desktopteam/blog/continued-stabilization" target="_blank">today&#039;s 10.50 snapshot release</a> we are starting public testing of our implementation of the &quot;Renego&quot; fix.
<br>
<br>At the moment you will not (or should not) notice any differences from the previous versions of Opera that does not have this fix. Part of the reason for releasing this snapshot is to discover if there are problems our testing have not uncovered. Another part of the reason is to allow TLS server vendors to perform interoperability tests of their servers against our client, to discover if there are problems in theirs or our understanding of the revised specification.
<br>
<br>As currently implemented Opera&#039;s Renego fix have the following features:
<br>
<br><ul class="bullets"><li>The update affects HTTPS, NNTP/POP/IMAP/SMTP/IRC over TLS
<br>  </li><li>We will send the RI extension in all handshakes using TLS Extensions
<br>  </li><li>We will send the SCSV when we don&#039;t know whether or not the server tolerates TLS Extensions (patched server MUST tolerate extensions, a reminder is included in the renego specification)
<br>  </li><li>If we know the server supports the RI extension we will <strong>always</strong> indicate support for TLS 1.2 and use extensions. If the patched server is incorrectly implemented the connection will fail (the renego specification reminds server vendors about the version tolerance requirement that have existed since SSL v3) and Opera WILL NOT attempt to use an older version in the handshake, as that would expose the user to a different, and currently hypothetical, security vulnerability, the version downgrade attack.
<br>  </li><li>It is a fatal error for a server (identified by name and port) to indicate RI extension support, and later not use it. We have to assume somebody is attempting to attack the connection.
<br>  </li><li> There is currently no indication in the UI when a server is vulnerable, but later there will be an indication in the security information dialog about unpatched servers. Currently the unpatched status is only indicated by the XML tag &quot;&lt;RenegExtensionUnsupported/&gt;&quot; in the security information document that you can find in the Info panel for the current document; the link to the document is the TLS Protocol field of the panel information.
<br>  </li><li>There is an auto-updatable preference, opera:config#SecurityPrefs|CryptoMethodOverrides , that can be used to enable warnings about unpatched servers, or disable support for them. 
<br>  </li><li>In the warn mode renegotiation is disabled against unpatched servers. Servers that rely on renegotiation should be among the first to patch this issue.
<br></li></ul>
<br>
<br>The reason we are currently allowing connections without warning to unpatched servers is that there are too many unpatched servers, essentially all of the ones currently on the net are unpatched. Displaying warnings at this time would be problematic from a user experience point of view.
<br>
<br>At a later date, not yet decided, when a large proportion of servers have been updated, we will auto-update the above preference and start warning about unpatched servers.
<br>
<br>Some, as yet unspecified, time after we have started to warn about unpatched server we will again auto-update the preference and <i>disable support</i> of unpatched servers. This eventual step is necessary in order to properly secure our users. As long as we allow connections to unpatched servers users are vulnerable to this attack, and if the vulnerable servers are not phased out as soon as possible (which in my <span style="text-decoration:underline">personal</span> opinion is at most 12 months) we will have this problem for years to come.
<br>
<br>Concerning our new policy of always identifying TLS 1.2 as our highest supported version: Previously Opera have spent time probing each secure server to determine which TLS version it could signal to the server, and whether TLS Extensions could be used with the server. Other clients have similar procedures. The reasons for this procedure is that many servers, about 6% according to my recent tests, does not handle these features well, even though the standards require them to. Clients have therefore had to adjust to these non-compliant servers. But this kind of adjustments make the clients and servers vulnerable to a version downgrade attack, which might become feasible at a later date if a problem is found in one of the older SSL/TLS versions.
<br>
<br>In the specification of the RenegotiationInfo Extension there is a reminder to server vendors about how they should handle clients supporting newer versions than the server, and TLS Extensions: They have to tolerate both. In this update, since all secure servers have to be updated to fix the renego issue, we are starting to enforce the version requirement of the SSL/TLS specification by always offering TLS 1.2 to renego patched servers, and expecting them to handle it. The servers does not need to support TLS 1.2 (though that would be preferable), it only have to tolerate clients that does. The Extension tolerance requirement is implied by the renego specification. The result of this policy change is that a second possible vulnerability is removed.
<br>
<br>Testserver: <a href="https://www.mikestoolbox.net/" target="_blank">https://www.mikestoolbox.net/</a> which is the same as was used with the <a href="http://my.opera.com/core/blog/2009/02/25/new-in-opera-presto-2-2-tls-1-2-support" target="_blank">TLS 1.2 testing</a>
<br>
<br><strong>The CryptoMethodOverrides preference</strong>
<br>
<br>The CryptoMethodOverrides preference (opera:config#SecurityPrefs|CryptoMethodOverrides ) mentioned above is a new preference we introduced in Opera 10 to allow us to auto-update Opera installations to warn about, or disable, security protocol features when they become critically weak. The preference is a <strong>decimal</strong> integer consisting of bitwise flags values ORed together. 
<br>
<br>Currently this preference have the following values (written in hexadecimal notation, the decimal version must be used in the preference) defined since 10.0:
<br>
<br><ul class="bullets"><li>0x01/0x02: Warn about/Disable MD5 signed certificates  
<br>  </li><li>0x04/0x08: Warn about/Disable SHA-1 signed certificates  
<br>  </li><li>0x10/0x20: Warn about/Disable SSL v3 support 
<br></li></ul>
<br>
<br>The MD5 and SHA-1 methods are weakening rapidly, though they are not yet broken, and we will likely need to disable support for MD5 in certificates within a couple of years,  at most; we completely disabled support for the much weaker <a href="http://my.opera.com/rootstore/blog/2009/07/31/globalsign-sha-256-verisign-roots-new-repository-version" target="_blank">MD2 method</a> in Opera 10.00. I expect SHA-1 to hold out for a few more years, but CAs are already preparing a migration to the stronger SHA-256 algorithm.
<br>
<br>As SSL v3 is using MD5 and SHA-1 directly, without the extra computational steps used by TLS 1.0 and TLS 1.1, it is likely that once SHA-1 becomes too weak, we should disable that version of the protocol, too. 
<br>
<br>We expect that there will be time for a period of warnings displayed about these problems before they are completely disabled.
<br>
<br>In today&#039;s build the following flags are added:
<br>
<br><ul class="bullets"><li>0x80: Disable EV indication for unpatched servers with EV certificates. We have not yet decided whether or not to flip this switch, or just use the warning flag. The renego issue is particularly severe for EV sites since the certificates are identifying the party you are talking to, and with the Renogo vulnerability you don&#039;t really know who you are talking to throughout the connection, or who the server talked to before it talked to you. Operators of EV sites should upgrade as soon as patched servers become available.
<br>  </li><li>0x0100: Warn about servers not having fixed the Renego issue. This triggers a certificate warning dialog, and you can configure an exception policy for the site. Our recommendation is to cancel the connection and report the issue to the web site&#039;s server administrator so that they can upgrade their server.
<br>  </li><li>0x0200: Disable support of unpatched servers. If enabled you will get a Fatal TLS error page, and will not be able to access the web site until they update their server.
<br></li></ul>
<br>
<br>The timings for if/when these settings will be enabled have not been decided, and much will depend on how quickly web site administrators update their servers.
<br>
<br>
<br><strong>Update February 9th, 2010:</strong>
<br>
<br>The Mozilla and NSS teams have now released test versions of their implementation of the Renego fix. Futher information can be found at their <a href="https://wiki.mozilla.org/Security:Renegotiation" target="_blank">Wiki</a>, with a test-server located at <a href="https://ssltls.de/" target="_blank">https://ssltls.de/</a> . Firefox nightly builds with the fix is <a href="ftp://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-mozilla-central/" target="_blank">available</a>.
<br>
<br><strong>Update February 12th, 2010:</strong>
<br>
<br>The Renego <a href="http://www.rfc-editor.org/rfc/rfc5746.txt" target="_blank">RFC</a> has been published
<br></div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}i:2;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:77:"
    <div lang="en" dir="ltr"> 512 bit RSA key breaking developments</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:28:"Yngve Nys√¶ter Pettersen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:55:"http://my.opera.com/securitygroup/blog/show.dml/4385459";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:46:"http://my.opera.com/securitygroup/blog/4385459";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2009-09-29T15:10:44Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:2407:"<div lang="en" dir="ltr">There has been a <a href="http://www.schneier.com/blog/archives/2009/09/texas_instrumen.html" target="_blank">bit of news</a> recently about a group&#039;s success in breaking the signature keys used for several Texas Instrument calculators.
<br>
<br>I take no position on whether or not this effort is justifiable. What is of interest to me and to the rest of the crypto user community is the length of the RSA keys involved (512 bit), and how long it took a single dual-core PC to crack a single key (73 days).
<br>
<br>This is important since we are still seeing Web sites (including online banking sites) using 512 bit keys to secure themselves. Seventy-three days is not that long considering a Web site certificate is usually valid for at least 365 days and sometimes for several years.
<br>
<br>Even more importantly, this was just a <strong>single</strong> computer. The work of breaking encryption keys can be spread (with varying degrees of efficiency) across <strong>many</strong> computers working in parallel. Assuming linear scaling of time use, with 10 computers the time will be close to 7-8 days (which is at the faster end of my <a href="http://my.opera.com/yngve/blog/2007/06/15/51-2-bit-banks" target="_blank">previous estimates</a> for breaking 512 bit). Use 100 and you are down to about 1 day. This means that a reasonable adversary could have at least 357 days of free access to listen in on, or impersonate such a site. What is reasonable? Let me put it this way: I have direct login access to at least 11 computers of varying capabilities, 5 of them my own, and most of them multi-core.
<br>
<br>This means that Web sites using 512 bit certificates should be considered <strong><span style="text-decoration:underline">cracked</span></strong> as soon as the certificate was used on the site. You should avoid doing any transactions at the site until they have upgraded their security.
<br>
<br>At Opera we have long considered 512 bit keys to be extremely weak, considering that they were
<br><a href="http://en.wikipedia.org/wiki/RSA_numbers#RSA-155" target="_blank"> broken ten years ago</a>. Opera will therefore display a certificate warning about the weak public key used by the site. This warning is currently displayed for keys with a length shorter than 900 bits, but this can be adjusted upwards, as needed, through our on-line update system.</div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}i:3;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:43:"
    <div lang="en" dir="ltr">9.64</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:24:"Claudio Santambrogio    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:55:"http://my.opera.com/securitygroup/blog/show.dml/3024427";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:46:"http://my.opera.com/securitygroup/blog/3024427";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2009-03-03T09:22:46Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:1766:"<div lang="en" dir="ltr">We released 9.64 today. This release is a recommended security upgrade for all those running the latest stable releases.
<br>
<br>
<br>Starting with this release, Opera on Windows supports the security measures &quot;Data Execution Prevention (DEP)&quot; (available in Windows XP SP2 and newer) and &quot;Address Space Layout Randomization (ASLR)&quot; (available in Vista and newer).
<br> 
<br>These security measures are a kind of second line of defence once an application runs into a serious fault, which would normally cause it to crash sooner or later. Of course that should just not happen in the first place, but you can never completely rule out programming errors. Depending on the exact nature of the fault, an attacker can sometimes exploit it and try to take over your system. DEP and ASLR make that a lot harder.
<br>
<br>
<br>We also added (on all platforms, of course) a new Untrusted Certificate capability, described in a
<br><a href="http://my.opera.com/rootstore/blog/2009/02/18/new-roots-ev-enabling-and-more-plus-the-end-of-a-brief-era" target="_blank">separate article</a>, and we are now blocking the fake certificate as mentioned in <a href="http://my.opera.com/securitygroup/blog/2009/01/30/md5-in-certificates-what-is-happening" target="_blank">another article</a>.
<br>
<br>
<br>Full changelogs are available:
<br><a href="http://www.opera.com/docs/changelogs/windows/964/" target="_blank">Windows</a>
<br><a href="http://www.opera.com/docs/changelogs/mac/964/" target="_blank">Mac</a>
<br><a href="http://www.opera.com/docs/changelogs/linux/964/" target="_blank">Linux/UNIX</a>
<br>
<br>Go <a href="http://www.opera.com/download/" target="_blank">download</a> it - and browse the web securely!  :sherlock: </div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}i:4;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:78:"
    <div lang="en" dir="ltr">MD5 in certificates: What is happening?</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:28:"Yngve Nys√¶ter Pettersen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:55:"http://my.opera.com/securitygroup/blog/show.dml/2941973";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:46:"http://my.opera.com/securitygroup/blog/2941973";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2009-01-30T16:06:04Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:16480:"<div lang="en" dir="ltr">A few weeks ago, just before New Year, news arrived that a group of security researchers had managed to create a fake intermediate CA certificate that was accepted by all browsers, because it was, to all appearances, signed by a Root <a href="http://en.wikipedia.org/wiki/Certificate_Authority" target="_blank">Certificate Authority</a> (CA) trusted by those browsers.
<br> 
<br>The fake intermediate CA certificate was, however, not signed by the Root CA. What the Root CA <i>had</i> signed was another certificate based on a completely valid request from the researchers, but the researchers had managed to craft that request -- and a second certificate -- in a way that the digital signature for the certificate signed by the Root CA could also be used by the second certificate.
<br> 
<br>The Root CA had two problems with their issuing procedure, and the researchers would have failed in their attack had only one of the problems been present.
<br> 
<br>The first problem was that they signed new <a href="http://en.wikipedia.org/wiki/Public_key_certificate" target="_blank">certificates</a> using the <a href="http://en.wikipedia.org/wiki/MD5" target="_blank">MD5 algorithm</a> to generate the signature of the certificate. MD5 has been showing signs of stress for many years, although it has not been broken yet. MD5 has, therefore, been on the short list for replacement for many years.
<br> 
<br>The second problem was that the Root CA was issuing certificates with a predictable serial number, not one that appears to be random (it might still be predictable, but only to the issuer), and almost all the other information in the relevant part of the certificate was either easy to predict (such as expiration date), or controlled by the researchers. In combination with the use of MD5 this meant that the researchers could create two certificates that would have the same signature.
<br> 
<br>Digital signatures have two components, a relatively short checksum (a <a href="http://en.wikipedia.org/wiki/Hash_algorithm" target="_blank">hash/digest</a>) calculated over the document that is to be signed -- MD5 is one such digest algorithm, <a href="http://en.wikipedia.org/wiki/SHA-1" target="_blank">SHA-1</a> and <a href="http://en.wikipedia.org/wiki/SHA-256" target="_blank">SHA-256</a> are others -- and that checksum is then encrypted using the signer&#039;s private key, usually an <a href="http://en.wikipedia.org/wiki/RSA" target="_blank">RSA</a> key, and the resulting signature is stored with the document. During verification, the checksum is calculated over the received document and compared against the signed checksum decrypted with the signer&#039;s public key (which is known to all).
<br> 
<br>Digest functions are called one-way functions because they are easy to calculate one way (calculate the checksum of a document), but it is <i>very</i> difficult to reverse the calculation (calculate the document that produced the checksum). These functions also have a second required attribute: changing a single bit in the document must produce a wildly different checksum; that is why these function are called hash-functions, because they slice, dice and generally make a hash of the bits in the document.
<br> 
<br>One way to attack a digest function is to find easy ways to calculate two documents that produce the same checksum. The very nature of digests, that the checksum is of finite length, means that there will always be an infinite number of documents that have the exact same checksum, known as collision.
<br> 
<br>It is &quot;relatively&quot; easy to find such collisions by using a method called the &quot;Birthday attack&quot;, after the fact that there is a 50% chance that in a room of 23 people you will find <a href="http://en.wikipedia.org/wiki/Birthday_Problem" target="_blank">two people having their birthday on the same day</a> of the year. The problem with the &quot;Birthday attack&quot; has always been creating messages that have meaning, such as a certificate, that will be accepted by a reader (human or machine).
<br> 
<br>In recent years, such collision attacks on MD5 have become better, and in the recent incident mentioned above, the researchers were able to make the necessary breakthroughs that allowed them to calculate two documents (certificates) that would be accepted by browsers verifying certificates, using &quot;just&quot; 3 days of calculation (bit tweaking, really) on 200 Playstation 3s. Essentially, they calculated two documents &quot;ABC&quot; and &quot;XYC&quot;, by changing B and Y, so that the signature for &quot;ABC&quot; would also verify &quot;XYC&quot;.
<br> 
<br>The researchers got an ordinary certificate from the Root CA, and were in possession of a second certificate, for which the same signature was valid. This second certificate was something we call an intermediate CA certificate, meaning it has the authority to sign yet new certificates. The intermediate CA certificate was then used to create a Web site certificate, and that certificate was accepted by the browsers, because the signatures verified all the way to the Root CA&#039;s certificate. However, neither the intermediate CA certificate, nor the Web site certificate had ever been authorized by the Root CA. The intermediate CA certificate, controlled by the researchers, was now in a position to create fake certificates for any Web site on the net. :yikes:
<br> 
<br>Fortunately, the intermediate CA certificate they created was intentionally configured so that it expired several years ago, so you will always get a certificate warning when accessing a site using a certificate issued by this &quot;CA&quot;.
<br> 
<br>The first consequence of this is that MD5 should not be used when issuing <i>new</i> certificates. Existing certificates, including Roots that are signed with MD5, are still secure and cannot be faked because the attacker needs to control the data of the certificate, and portions of the data sent to the issuer have to contain random data that are chosen as part of the calculation process; otherwise the attack becomes much harder.
<br> 
<br>The CA in question have already stopped issuing certificates using MD5, and have AFAIK implemented other countermeasures, such as random serial numbers, so the attack is no longer possible. There are currently no indications that what the researchers did had been duplicated by anyone before they published their results, and considering the (as yet unpublished) new theory they had to develop, it is unlikely that anyone has.
<br> 
<br>Given the steps that have been taken, this proof of concept is unlikely to affect the security of users.
<br> 
<br>The second consequence is that use of MD5 (and the weaker MD2 function) in protocols, including certificates, should be phased out as quickly as possible. &quot;Attacks always get better, they never get worse&quot;, to quote <a href="http://www.schneier.com/blog/archives/2007/02/a_new_secure_ha.html" target="_blank">Bruce Schneier and the NSA</a>, so it is only a question of time before attacks that are currently unfeasible will become feasible.
<br> 
<br>That is a much larger task, one that cannot be done overnight.
<br> 
<br><strong><a href="http://en.wikipedia.org/wiki/Public_key_certificate" target="_blank">Certificates</a></strong>: A large fraction (30% according to the researchers, 14% according to <a href="http://news.netcraft.com/archives/2009/01/01/14_of_ssl_certificates_signed_using_vulnerable_md5_algorithm.html" target="_blank">Netcraft</a>) of
<br>certificates used by Web sites are still signed using MD5, and then we are probably not counting the certificates that chain to a MD5 or <a href="http://en.wikipedia.org/wiki/MD2_(cryptography)" target="_blank">MD2</a> signed root. Disabling MD5 and MD2 in certificate verification today would, almost quite literally, break the Internet. Most certificates today are signed using the more secure <a href="http://en.wikipedia.org/wiki/SHA-1" target="_blank">SHA-1</a> function, but steps are being taken to start using the even more secure SHA-256 function for signatures. Opera 9.0 and later are able to handle certificates signed using SHA-256, as are a number of other modern browsers, but there are quite a few browser users out there with browsers that cannot handle <a href="http://en.wikipedia.org/wiki/SHA-256" target="_blank">SHA-256</a>, and the problem of how to migrate to SHA-256 without breaking the Internet has not yet been solved.
<br> 
<br>Please note that <a href="http://www.cabforum.org/certificates.html" target="_blank">Extended Validation</a> (EV) certificates are not affected by this. EV site certificates and intermediate CA certificates cannot be signed using MD5, and no Root using 1024 bit keys are accepts for EV in Opera.
<br> 
<br><strong><a href="http://www.mozilla.org/projects/security/pki/nss/ssl/draft302.txt" target="_blank">SSL v3</a></strong>: SSL version 3, the oldest version of the SSL/TLS protocol that Opera supports, uses MD5 directly as part of several functions, including key calculation; however, due to the design of the protocol, for most purposes, MD5 is combined with another more secure method, SHA-1, even a complete break of MD5 should not compromise the security of SSL v3. Considering that SHA-1 is also showing signs of stress, though considered to be secure for several more years, Web sites should move away from using servers that only support SSL v3 (such servers are also, usually, more than 8 years old). While it is currently not practical to disable support for SSL v3, it may become necessary in a few years.
<br> 
<br><strong><a href="http://tools.ietf.org/html/rfc2246" target="_blank">TLS v1.0</a> and <a href="http://tools.ietf.org/html/rfc4346" target="_blank">v1.1</a></strong>: These two versions of TLS both use MD5 in combination with SHA-1, like SSL v3, but use these functions indirectly in a multistep &quot;keyed&quot; operation called <a href="http://en.wikipedia.org/wiki/HMAC" target="_blank">HMAC</a>, where the input data is combined with other data, and the result is then recalculated a second time -- a procedure that foils several types of attacks on these functions. Unless there are problems with the HMAC construction, TLS v1.0 and v1.1 are likely to remain secure for quite some time, but Web sites are encouraged to adopt TLS v1.2 as soon as it becomes available in servers.
<br>
<br><strong><a href="http://tools.ietf.org/html/rfc5246" target="_blank">TLS v1.2</a></strong>: This is the newest version of TLS, and one first available in Opera 10.0 alpha (Opera Presto 2.2). This version of TLS no longer use MD5 or SHA-1 as part of the protocol, but has changed to using the more secure SHA-256 function for the operations for which MD5 and SHA-1 have been used in SSL v3, TLS v1.0 and TLS 1.1. The only functionality for which MD5 and SHA-1 (together with HMAC) are still used is in the checksums for each encrypted record, but these are still considered reasonably secure. TLS v1.2 also has encryption specifications that use SHA-256, and those are the preferred ones.
<br>
<br>While the SSL/TLS protocols versions should be secure for several more years, server vendors should add support for TLS 1.2 and SHA-256 as soon as possible. Web site administrators should start using TLS v1.2 servers as soon as they become available, and in the meantime migrate to servers using TLS v1.1. This will provide their customers with the best available security.
<br> 
<br>Web surfers should of course at any time use the most up to date version of their browser.
<br>
<br><strong>What steps are Opera planning?</strong>
<br>
<br>We have considered blacklisting the fake intermediate CA certificate, but currently we are leaning towards not doing so. In the new <a href="http://my.opera.com/rootstore/blog/2008/07/03/rootstore-newsletter" target="_blank">online certificate repository</a>, we can tell all 9.50+ installations not to trust specific certificates, and we will do so if it is necessary, particularly if a Root is compromised. However, in this case we are dealing with a single demonstration Web site and an expired fake intermediate CA certificate created by a group of researchers that have stated that they will keep the private key for that certificate safe. Marking the certificate untrusted in all installations will, under the circumstances, be a bit of an overkill.
<br>
<br>We are, however, planning some changes to the blacklist functionality to make it scale better and be more targeted. Primarily we would like the blacklist to be updated only when the user actually encounters a potentially blacklisted certificate.
<br>
<br>In the long term we are very likely going to require all Web site certificates chained to a Root (that is, except self-signed site certificates) to be validated using online validity checks, based on <a href="http://en.wikipedia.org/wiki/OCSP" target="_blank">OCSP</a> and <a href="http://en.wikipedia.org/wiki/Certificate_revocation_list" target="_blank">CRLs</a>, and refuse to connect if some of the non-Root certificates in the chain cannot be checked against either of those validation systems. One of the things the fake CA in this case did not provide was a URL to a CRL that could be used to validate it. Such a step is unlikely to cause disruption for Web sites using a certificate issued from one of the CAs in the Rootstore, but it might cause problems for certificates created by system administrators that roll their own Root certificates. It might also cause problems at Wi-Fi hotspots and ISP networks that restrict external access before payment have been accepted. The benefit of such a policy would be that all certificates would be checked frequently.
<br>
<br>We are not going to disable MD5 in certificates for some time. We have asked some CAs to provide information about their phase out plans, but I would be surprised if we can do that within a year. However, all of the affected Roots are using 1024 bit <a href="http://en.wikipedia.org/wiki/RSA" target="_blank">RSA</a> keys, which means that they are no longer recommended for use past 2010. Therefore, the CAs are already in the process of migrating customers away from those Roots over to Roots with stronger keys.
<br>
<br>Another possibility that we are considering regarding MD5 is to add a remote updatable preference to Opera that allows us to turn off MD5 in certificates in all installations at some time. This would mean that, when MD5 is no longer considered secure, or necessary, users would not have to install a new version to disable MD5.
<br>
<br>We are also considering, just to be on the safe side, whether or not to disable the single remaining SSL/TLS cipher suite using MD5, the 128 bit <a href="http://en.wikipedia.org/wiki/Rc4" target="_blank">ARC4(RC4)</a> with RSA key exchange and MD5 for integrity checking (128 bit ARC4-RSA/MD5). Before we decide on that, we need to check how many servers that support only that method (there is a SHA-1 variant that is preferred by Opera). My guess is that all servers support at least the 128 bit ARC4-RSA/SHA-1 variant, meaning that there will be no significant disruption if we do this.
<br>
<br>The process we are seeing, of ever better attacks on MD5, is part of life for encryption algorithms. All encryption algorithms have a use-by date, although it may not be easy to find, which is why most protocols allow the algorithms to be changed or can be updated to use new ones. Changing from one method to another, more secure method is a process that usually takes several years, particularly in the case of the Internet, due to the number of installed servers and clients that have to continue to work without disruption. This concern is often the reason why disabling of unsecure protocols and methods take longer than one could wish.
<br>
<br>
<br>More information about the MD5 certificate problem can be found here:
<br> 
<br><ul class="bullets"><li> The researchers&#039; <a href="http://www.win.tue.nl/hashclash/rogue-ca/" target="_blank">report</a>
<br>  </li><li> <a href="http://www.educatedguesswork.org/2008/12/understanding_the_sotirov_et_a.html" target="_blank">Eric Rescorla</a>, co-chair of the TLS work group and author of the TLS 1.1 and TLS 1.2 specifications
<br>  </li><li> <a href="http://www.technologyreview.com/computing/21946/" target="_blank">MIT Technology Review</a>
<br></li></ul>
<br> </div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}i:5;a:6:{s:4:"data";s:19:"
  
  
  
  
  
  
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:6:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:81:"
    <div lang="en" dir="ltr">Introducing the Security @ Opera home page</div>
  ";s:7:"attribs";a:2:{s:0:"";a:1:{s:4:"type";s:5:"xhtml";}s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}s:6:"author";a:1:{i:0;a:6:{s:4:"data";s:8:"
    
  ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"name";a:1:{i:0;a:5:{s:4:"data";s:28:"Yngve Nys√¶ter Pettersen    ";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:4:"href";s:55:"http://my.opera.com/securitygroup/blog/show.dml/2941811";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:2:"id";a:1:{i:0;a:5:{s:4:"data";s:46:"http://my.opera.com/securitygroup/blog/2941811";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"updated";a:1:{i:0;a:5:{s:4:"data";s:20:"2009-01-30T14:16:47Z";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"content";a:1:{i:0;a:5:{s:4:"data";s:787:"<div lang="en" dir="ltr">Welcome to the new home page of the Opera Security Group.
<br> 
<br>This is where we are going to announce security updates, links to advisories, and occasional articles with information about security topics related to Opera.
<br> 
<br>You can find out more about Opera&#039;s policies for security vulnerabilities at <a href="http://www.opera.com/security/" target="_blank">this page</a>. We prefer that security vulnerabilities, like all bugs, are reported via our <a href="https://bugs.opera.com/wizard/" target="_blank">bug-tracking system</a>, although we do also accept reports via the e-mail address security (at) opera dot com  (PGP key can be found in this <a href="http://labs.opera.com/news/2006/08/01/" target="_blank">Opera Labs article</a>).</div>";s:7:"attribs";a:2:{s:36:"http://www.w3.org/XML/1998/namespace";a:1:{s:4:"lang";s:2:"en";}s:0:"";a:1:{s:4:"type";s:5:"xhtml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:2:"en";}}}}}}}}}}}}s:4:"type";i:512;s:7:"headers";a:4:{s:4:"date";s:29:"Sun, 07 Mar 2010 09:36:27 GMT";s:6:"server";s:75:"Apache/2.2.9 (Debian) mod_apreq2-20051231/2.6.0 mod_perl/2.0.4 Perl/v5.10.0";s:12:"content-type";s:20:"application/atom+xml";s:17:"transfer-encoding";s:7:"chunked";}s:5:"build";i:20081219;}